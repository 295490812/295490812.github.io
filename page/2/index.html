<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.0.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-react-spring动画库" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/11/29/react-spring%E5%8A%A8%E7%94%BB%E5%BA%93/" class="article-date">
  <time datetime="2019-11-29T03:55:11.000Z" itemprop="datePublished">2019-11-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/react/">react</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/11/29/react-spring%E5%8A%A8%E7%94%BB%E5%BA%93/">react-spring动画库</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-React-Spring动画库"><a href="#1-React-Spring动画库" class="headerlink" title="1. React Spring动画库"></a>1. React Spring动画库</h2><p><a target="_blank" rel="noopener" href="https://www.react-spring.io/docs/hooks/basics">https://www.react-spring.io/docs/hooks/basics</a></p>
<h3 id="1-1-基本用法"><a href="#1-1-基本用法" class="headerlink" title="1.1 基本用法"></a>1.1 基本用法</h3><p>React Spring是使用于reactjs的动画工具库，因为依据 react-motio作者Cheng Lou的演讲观点95%以上的动画特效使用spring即可达到可用的效果，以往那种时间间隔和曲线的动画理念生硬又复杂。</p>
<p>react-spring库中UseSpring和animated</p>
<p>UseSpring是一个可以设置样式的自定义钩子，它接受一个对象，该对象具有from和to值作为开始和结束状态，react-spring正是用这两个状态来处理过渡的动画效果。from和to几乎可以设置所有的CSS属性对象：颜色，大小，transform，甚至滚动条。</p>
<p>只需要在HTML标签上增加animated就可以应用spring动画。默认情况下，动画会在组件挂载的时候立即执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.改变透明度</span></span><br><span class="line"><span class="keyword">const</span> animation = useSpring(&#123;</span><br><span class="line">    <span class="keyword">from</span>: &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</span><br><span class="line">    to: &#123; <span class="attr">opacity</span>: <span class="number">1</span> &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.改变颜色</span></span><br><span class="line"><span class="keyword">const</span> colorAnimation = useSpring(&#123;</span><br><span class="line">    config: &#123; <span class="attr">duration</span>: <span class="number">4000</span> &#125;,</span><br><span class="line">    delay: <span class="number">2000</span>,</span><br><span class="line">    <span class="keyword">from</span>: &#123; <span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span> &#125;,</span><br><span class="line">    to: &#123; <span class="attr">color</span>: <span class="string">`rgb(255,0,0)`</span> &#125;,</span><br><span class="line">    <span class="comment">/*从from到to的过程开启动画*/</span></span><br><span class="line">    reset: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">/*reverse:会自动反转from和to的值，这个值只有在联合reset:true的情况下才生效*/</span></span><br><span class="line">    reverse: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">/*动画的回调函数*/</span></span><br><span class="line">    onStart: <span class="function">() =&gt;</span> &#123; <span class="built_in">console</span>.log(<span class="string">&quot;动画开始&quot;</span>) &#125;,</span><br><span class="line">    onRest: <span class="function">() =&gt;</span> &#123; <span class="built_in">console</span>.log(<span class="string">&quot;动画停止&quot;</span>) &#125;,</span><br><span class="line">    onFrame: <span class="function">(<span class="params">v</span>) =&gt;</span> &#123; <span class="built_in">console</span>.log(<span class="string">&quot;动画过程中的回调函数&quot;</span>, v) &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">config的一些配置参数：</span></span><br><span class="line"><span class="comment">    mass：影响速度以及过渡的效果。</span></span><br><span class="line"><span class="comment">    tension：影响整体速度。</span></span><br><span class="line"><span class="comment">    friction：控制阻力及其减速的速度。</span></span><br><span class="line"><span class="comment">    clamp：是否应该瞬间过渡。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">官方提供的一些有用的预设值搭配：</span></span><br><span class="line"><span class="comment">    config.default &#123; mass: 1, tension: 170, friction: 26 &#125;</span></span><br><span class="line"><span class="comment">    config.gentle &#123; mass: 1, tension: 120, friction: 14 &#125;</span></span><br><span class="line"><span class="comment">    config.wobbly &#123; mass: 1, tension: 180, friction: 12 &#125;</span></span><br><span class="line"><span class="comment">    config.stiff &#123; mass: 1, tension: 210, friction: 20 &#125;</span></span><br><span class="line"><span class="comment">    config.slow &#123; mass: 1, tension: 280, friction: 60 &#125;</span></span><br><span class="line"><span class="comment">    config.molasses &#123; mass: 1, tension: 280, friction: 120 &#125;   </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.改变透明度和颜色  多个状态改变</span></span><br><span class="line"><span class="keyword">const</span> multiAnimation = useSpring(&#123;</span><br><span class="line">    <span class="keyword">from</span>: &#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span> &#125;,</span><br><span class="line">    to: [</span><br><span class="line">        &#123; <span class="attr">opacity</span>: <span class="number">1</span>, <span class="attr">color</span>: <span class="string">&#x27;#ffaaee&#x27;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">opacity</span>: <span class="number">1</span>, <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">opacity</span>: <span class="number">.5</span>, <span class="attr">color</span>: <span class="string">&#x27;#008000&#x27;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">opacity</span>: <span class="number">.8</span>, <span class="attr">color</span>: <span class="string">&#x27;black&#x27;</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;animated.h1 style=&#123;animation&#125;&gt;Hello World&lt;/animated.h1&gt;</span><br><span class="line">        &lt;animated.h1 style=&#123;colorAnimation&#125;&gt;Hello World&lt;/animated.h1&gt;</span><br><span class="line">        &lt;animated.h1 style=&#123;multiAnimation&#125;&gt;Hello World&lt;/animated.h1&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//案例---循环变动</span></span><br><span class="line"></span><br><span class="line">#1.App.jsx</span><br><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSpring, animated, interpolate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./app.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> animation = useSpring(&#123;</span><br><span class="line">        <span class="keyword">from</span>: &#123; <span class="attr">left</span>: <span class="string">&#x27;0%&#x27;</span>, <span class="attr">top</span>: <span class="string">&#x27;0%&#x27;</span>, <span class="attr">width</span>: <span class="string">&#x27;0%&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;0%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightgreen&#x27;</span> &#125;,</span><br><span class="line">        to: <span class="keyword">async</span> next =&gt; &#123;</span><br><span class="line">          <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">await</span> next(&#123; <span class="attr">left</span>: <span class="string">&#x27;0%&#x27;</span>, <span class="attr">top</span>: <span class="string">&#x27;0%&#x27;</span>, <span class="attr">width</span>: <span class="string">&#x27;100%&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;100%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightblue&#x27;</span> &#125;)</span><br><span class="line">            <span class="keyword">await</span> next(&#123; <span class="attr">height</span>: <span class="string">&#x27;50%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightgreen&#x27;</span> &#125;)</span><br><span class="line">            <span class="keyword">await</span> next(&#123; <span class="attr">width</span>: <span class="string">&#x27;50%&#x27;</span>, <span class="attr">left</span>: <span class="string">&#x27;50%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightgoldenrodyellow&#x27;</span> &#125;)</span><br><span class="line">            <span class="keyword">await</span> next(&#123; <span class="attr">top</span>: <span class="string">&#x27;0%&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;100%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightpink&#x27;</span> &#125;)</span><br><span class="line">            <span class="keyword">await</span> next(&#123; <span class="attr">top</span>: <span class="string">&#x27;50%&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;50%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightsalmon&#x27;</span> &#125;)</span><br><span class="line">            <span class="keyword">await</span> next(&#123; <span class="attr">width</span>: <span class="string">&#x27;100%&#x27;</span>, <span class="attr">left</span>: <span class="string">&#x27;0%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightcoral&#x27;</span> &#125;)</span><br><span class="line">            <span class="keyword">await</span> next(&#123; <span class="attr">width</span>: <span class="string">&#x27;50%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightseagreen&#x27;</span> &#125;)</span><br><span class="line">            <span class="keyword">await</span> next(&#123; <span class="attr">top</span>: <span class="string">&#x27;0%&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;100%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightskyblue&#x27;</span> &#125;)</span><br><span class="line">            <span class="keyword">await</span> next(&#123; <span class="attr">width</span>: <span class="string">&#x27;100%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;lightslategrey&#x27;</span> &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">animated.div</span> <span class="attr">className</span>=<span class="string">&quot;script-box&quot;</span> <span class="attr">style</span>=<span class="string">&#123;animation&#125;</span> /&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.app.css</span><br><span class="line">* &#123;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  html,</span><br><span class="line">  body,</span><br><span class="line">  #root &#123;</span><br><span class="line">    width: <span class="number">100</span>%;</span><br><span class="line">    height: <span class="number">100</span>%;</span><br><span class="line">    margin: <span class="number">0</span>;</span><br><span class="line">    padding: <span class="number">0</span>;</span><br><span class="line">    background-color: white;</span><br><span class="line">    -webkit-touch-callout: none;</span><br><span class="line">    -webkit-user-select: none;</span><br><span class="line">    -khtml-user-select: none;</span><br><span class="line">    -moz-user-select: none;</span><br><span class="line">    -ms-user-select: none;</span><br><span class="line">    user-select: none;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  #app &#123;</span><br><span class="line">    background: #f0f0f0;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    position: relative;</span><br><span class="line">    width: <span class="number">100</span>%;</span><br><span class="line">    height: <span class="number">100</span>%;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  .script-box &#123;</span><br><span class="line">    will-change: width, height, left, top;</span><br><span class="line">    position: relative;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//给组件添加动画</span></span><br><span class="line"><span class="keyword">const</span> Demo4 = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//当我们要对组件进行动画的时候，我们需要使用animated方法把组件包裹起来，然后直接使用包裹后的组件名字</span></span><br><span class="line">    <span class="keyword">const</span> AnimatedDonut4 = animated(Donut4)</span><br><span class="line">    <span class="comment">//创建一个动画:该动画完成从value=0变化到value=100的过程</span></span><br><span class="line">    <span class="keyword">const</span> donutAnimation = useSpring(&#123; <span class="attr">from</span>: &#123; <span class="attr">value</span>: <span class="number">0</span> &#125;, <span class="attr">value</span>: <span class="number">100</span> ,<span class="attr">config</span>: &#123; <span class="attr">duration</span>: <span class="number">2000</span> &#125;&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;AnimatedDonut4&gt;</span><br><span class="line">        &lt;/AnimatedDonut4&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Demo4;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-interpolate的用法"><a href="#1-2-interpolate的用法" class="headerlink" title="1.2 interpolate的用法"></a>1.2 interpolate的用法</h3><p>除了仅对元素和组件添加静态样式更改之外，我们还可以使用Interpolate创建更有趣和可重用的动画。interpolate方法可以用来在动画执行的过程中，根据给定的起始、最终值，计算动画的每一步需要的值。interpolate还有一个作用可以让我们模拟css的关键帧。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; o, xyz, color &#125; = useSpring(&#123;</span><br><span class="line">        <span class="keyword">from</span>: &#123; <span class="attr">o</span>: <span class="number">0</span>, <span class="attr">xyz</span>: [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span> &#125;,</span><br><span class="line">        to: &#123; <span class="attr">o</span>: <span class="number">1</span>, <span class="attr">xyz</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">5</span>], <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span> &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &#123;<span class="comment">/*  Interpolate :允许我们提取变量值，转换成对应的动画样式</span></span><br><span class="line"><span class="comment">               Interpolate还有一个作用可以让我们模拟css的关键帧</span></span><br><span class="line"><span class="comment">            */</span>&#125;</span><br><span class="line">            &lt;animated.div</span><br><span class="line">                style=&#123;&#123;</span><br><span class="line">                    color,</span><br><span class="line">                    <span class="comment">//改变背景色 o作为入参</span></span><br><span class="line">                    background: o.interpolate(<span class="function"><span class="params">o</span> =&gt;</span> <span class="string">`rgba(210, 57, 77, <span class="subst">$&#123;o&#125;</span>)`</span>),</span><br><span class="line">                    <span class="comment">//改变transform xyz作为入参</span></span><br><span class="line">                    transform: xyz.interpolate(<span class="function">(<span class="params">x, y, z</span>) =&gt;</span> <span class="string">`translate3d(<span class="subst">$&#123;x&#125;</span>px, <span class="subst">$&#123;y&#125;</span>px, <span class="subst">$&#123;z&#125;</span>px)`</span>),</span><br><span class="line">                    <span class="comment">//直接调用interpolate方法可以合并多个值，这边border使用多个值来设定样式</span></span><br><span class="line">                    border: interpolate([o, color], <span class="function">(<span class="params">o, c</span>) =&gt;</span> <span class="string">`<span class="subst">$&#123;o * <span class="number">10</span>&#125;</span>px solid <span class="subst">$&#123;c&#125;</span>`</span>),</span><br><span class="line">                    <span class="comment">/*关键帧:range对应动画的阶段，output对应每一个动画阶段的输出值*/</span></span><br><span class="line">                    padding: o.interpolate(&#123; <span class="attr">range</span>: [<span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>], <span class="attr">output</span>: [<span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>] &#125;).interpolate(<span class="function"><span class="params">o</span> =&gt;</span> <span class="string">`<span class="subst">$&#123;o&#125;</span>%`</span>),</span><br><span class="line">                    borderColor: o.interpolate(&#123; <span class="attr">range</span>: [<span class="number">0</span>, <span class="number">1</span>], <span class="attr">output</span>: [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;#ffaabb&#x27;</span>] &#125;),</span><br><span class="line">                    <span class="comment">/*关键帧：省略range和output*/</span></span><br><span class="line">                    opacity: o.interpolate([<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.6</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">0.1</span>, <span class="number">0.5</span>, <span class="number">1</span>])</span><br><span class="line">                &#125;&#125;</span><br><span class="line">            &gt;</span><br><span class="line">                &#123;<span class="comment">/*保留两位小数*/</span>&#125;</span><br><span class="line">                &#123;o.interpolate(<span class="function"><span class="params">n</span> =&gt;</span> n.toFixed(<span class="number">2</span>))&#125;</span><br><span class="line">            &lt;/animated.div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//进度条</span></span><br><span class="line">#1.Donut.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSpring, animated, interpolate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/styles/donut.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Donut4 = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; width &#125; = useSpring(&#123; <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">from</span>: &#123; <span class="attr">width</span>: <span class="number">0</span> &#125; &#125;)</span><br><span class="line">    <span class="keyword">const</span> a = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div className=<span class="string">&quot;main&quot;</span>&gt;</span><br><span class="line">            &#123;<span class="comment">/*注意点：只有动画的属性才可以使用interpolate方法，普通的变量是不可以interpolate方法的 */</span>&#125;</span><br><span class="line">            &#123;<span class="comment">/* &lt;animated.div&gt;&#123;a.interpolate(v=&gt;v)&#125;&lt;/animated.div&gt; */</span>&#125;</span><br><span class="line">            &lt;animated.div className=<span class="string">&quot;fill&quot;</span> style=&#123;&#123;<span class="attr">width</span>:width.interpolate(<span class="function"><span class="params">v</span>=&gt;</span>v+<span class="string">&#x27;%&#x27;</span>)&#125;&#125;&gt;&lt;/animated.div&gt;</span><br><span class="line">            &lt;animated.div className=<span class="string">&quot;content&quot;</span>&gt;&#123;width.interpolate(<span class="function"><span class="params">v</span>=&gt;</span>v.toFixed(<span class="number">0</span>))&#125;&lt;/animated.div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Donut4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.donut.css</span><br><span class="line">.main&#123;</span><br><span class="line">    height: <span class="number">50</span>px;</span><br><span class="line">    line-height: <span class="number">50</span>px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    position: relative;</span><br><span class="line">    width: <span class="number">500</span>px;</span><br><span class="line">    color: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.main .fill&#123;</span><br><span class="line">    height: <span class="number">100</span>%;</span><br><span class="line">    background: blue;</span><br><span class="line">    border-radius: <span class="number">10</span>px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: <span class="number">0</span>px;</span><br><span class="line">    top: <span class="number">0</span>px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.main .content&#123;</span><br><span class="line">    z-index: <span class="number">999</span>;</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: <span class="number">0</span>px;</span><br><span class="line">    top: <span class="number">0</span>px;</span><br><span class="line">    width: <span class="number">100</span>%;</span><br><span class="line">    height: <span class="number">100</span>%;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-useSpring的用法"><a href="#1-3-useSpring的用法" class="headerlink" title="1.3 useSpring的用法"></a>1.3 useSpring的用法</h3><h4 id="a-通过state切换动画"><a href="#a-通过state切换动画" class="headerlink" title="a) 通过state切换动画"></a>a) 通过state切换动画</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSpring, animated, interpolate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//注意：react-spring只能在hooks中使用，hooks是函数组件的新特性</span></span><br><span class="line">    <span class="comment">//因此react-spring只能在函数组件中用，函数组件中要声明state，需要借助useState()来完成</span></span><br><span class="line">    <span class="comment">//注意点：函数组件中没有this</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.声明一个state</span></span><br><span class="line">    <span class="keyword">const</span> [flag, setFlag] = useState(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.改变透明度动画 这边to的状态受到flag这个state控制</span></span><br><span class="line">    <span class="keyword">const</span> animation = useSpring(&#123;</span><br><span class="line">        <span class="keyword">from</span>: &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</span><br><span class="line">        to: &#123; <span class="attr">opacity</span>: flag ? <span class="number">1</span> : <span class="number">0</span> &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;animated.h1 style=&#123;animation&#125;&gt;Hello World&lt;/animated.h1&gt;</span><br><span class="line">            &#123;<span class="comment">/*点击按钮的时候切换state状态，从而切换动画*/</span>&#125;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">()=&gt;</span>&#123;setFlag(<span class="function"><span class="params">state</span>=&gt;</span>!state)&#125;&#125;&gt;点我切换&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//案例---点击翻转图片</span></span><br><span class="line">#1.App.jsx</span><br><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSpring, animated, interpolate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./app.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [flipped, setFlipped] = useState(<span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">const</span> &#123; transform, opacity &#125; = useSpring(&#123;</span><br><span class="line">        opacity: flipped ? <span class="number">1</span> : <span class="number">0</span>,</span><br><span class="line">        transform: <span class="string">`perspective(600px) rotateX(<span class="subst">$&#123;flipped ? <span class="number">180</span> : <span class="number">0</span>&#125;</span>deg)`</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div onClick=&#123;<span class="function">() =&gt;</span> setFlipped(<span class="function"><span class="params">state</span> =&gt;</span> !state)&#125;&gt;</span><br><span class="line">            &lt;animated.div className=<span class="string">&quot;c back&quot;</span> style=&#123;&#123; <span class="attr">opacity</span>: opacity.interpolate(<span class="function"><span class="params">o</span> =&gt;</span> <span class="number">1</span> - o), transform &#125;&#125; /&gt;</span><br><span class="line">            &lt;animated.div className=<span class="string">&quot;c front&quot;</span> style=&#123;&#123; opacity, <span class="attr">transform</span>: transform.interpolate(<span class="function"><span class="params">t</span> =&gt;</span> <span class="string">`<span class="subst">$&#123;t&#125;</span> rotateX(180deg)`</span>) &#125;&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.app.css</span><br><span class="line"></span><br><span class="line">html,</span><br><span class="line">body,</span><br><span class="line">#app &#123;</span><br><span class="line">  margin: <span class="number">0</span>;</span><br><span class="line">  padding: <span class="number">0</span>;</span><br><span class="line">  height: <span class="number">100</span>%;</span><br><span class="line">  width: <span class="number">100</span>%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  user-select: none;</span><br><span class="line">  background: #f0f0f0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#app &gt; div &#123;</span><br><span class="line">  width: <span class="number">100</span>%;</span><br><span class="line">  height: <span class="number">100</span>%;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.c &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  max-width: <span class="number">500</span>px;</span><br><span class="line">  max-height: <span class="number">500</span>px;</span><br><span class="line">  width: <span class="number">50</span>ch;</span><br><span class="line">  height: <span class="number">50</span>ch;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  will-change: transform, opacity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.front,</span><br><span class="line">.back &#123;</span><br><span class="line">  background-size: cover;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.back &#123;</span><br><span class="line">  background-image: url(https:<span class="comment">//images.unsplash.com/photo-1544511916-0148ccdeb877?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;w=1901&amp;q=80i&amp;auto=format&amp;fit=crop);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.front &#123;</span><br><span class="line">  background-image: url(https:<span class="comment">//images.unsplash.com/photo-1540206395-68808572332f?ixlib=rb-1.2.1&amp;w=1181&amp;q=80&amp;auto=format&amp;fit=crop);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="b-手动切换动画"><a href="#b-手动切换动画" class="headerlink" title="b) 手动切换动画"></a>b) 手动切换动画</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSpring, animated, interpolate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1.useSpring()接收箭头函数，此时会返回一个数组</span></span><br><span class="line">    <span class="comment">//通过解构赋值获取到useSpring()函数返回的结果  animation表示动画属性，set可以用来修改动画属性，stop可以用来停止动画</span></span><br><span class="line">    <span class="keyword">const</span> [animation, set, stop] = useSpring(<span class="function">() =&gt;</span> (&#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &#123;<span class="comment">/*2.鼠标移入和移出改变透明度*/</span>&#125;</span><br><span class="line">            &lt;animated.div style=&#123;animation&#125; onMouseOver=&#123;<span class="function">()=&gt;</span>&#123;set(&#123;<span class="attr">opacity</span>:<span class="number">1</span>&#125;)&#125;&#125; onMouseOut=&#123;<span class="function">()=&gt;</span>&#123;set(&#123;<span class="attr">opacity</span>:<span class="number">0</span>&#125;)&#125;&#125;&gt;i will fade&lt;/animated.div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//案例-图层移动</span></span><br><span class="line">#1.App.jsx</span><br><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSpring, animated, interpolate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./app.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//根据鼠标位置计算相对于图片中心点的坐标</span></span><br><span class="line">    <span class="keyword">const</span> calc = <span class="function">(<span class="params">x, y</span>) =&gt;</span> [x - <span class="built_in">window</span>.innerWidth / <span class="number">2</span>, y - <span class="built_in">window</span>.innerHeight / <span class="number">2</span>]</span><br><span class="line">    <span class="comment">//不同的图片给于不同的动画函数</span></span><br><span class="line">    <span class="keyword">const</span> trans1 = <span class="function">(<span class="params">x, y</span>) =&gt;</span> <span class="string">`translate3d(<span class="subst">$&#123;x <span class="regexp">/ 10&#125;px,$&#123;y /</span> <span class="number">10</span>&#125;</span>px,0)`</span></span><br><span class="line">    <span class="keyword">const</span> trans2 = <span class="function">(<span class="params">x, y</span>) =&gt;</span> <span class="string">`translate3d(<span class="subst">$&#123;x <span class="regexp">/ 8 + 35&#125;px,$&#123;y /</span> <span class="number">8</span> - <span class="number">230</span>&#125;</span>px,0)`</span></span><br><span class="line">    <span class="keyword">const</span> trans3 = <span class="function">(<span class="params">x, y</span>) =&gt;</span> <span class="string">`translate3d(<span class="subst">$&#123;x <span class="regexp">/ 6 - 250&#125;px,$&#123;y /</span> <span class="number">6</span> - <span class="number">200</span>&#125;</span>px,0)`</span></span><br><span class="line">    <span class="keyword">const</span> trans4 = <span class="function">(<span class="params">x, y</span>) =&gt;</span> <span class="string">`translate3d(<span class="subst">$&#123;x <span class="regexp">/ 3.5&#125;px,$&#123;y /</span> <span class="number">3.5</span>&#125;</span>px,0)`</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建动画(这边只入参xy 然后再根据入参的xy计算每个div的动画属性)</span></span><br><span class="line">    <span class="keyword">const</span> [amimation, set] = useSpring(<span class="function">() =&gt;</span> (&#123; <span class="attr">xy</span>: [<span class="number">0</span>, <span class="number">0</span>], <span class="attr">config</span>: &#123; <span class="attr">mass</span>: <span class="number">10</span>, <span class="attr">tension</span>: <span class="number">550</span>, <span class="attr">friction</span>: <span class="number">140</span> &#125; &#125;))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (<span class="comment">/*根据鼠标位置，计算xy*/</span></span><br><span class="line">        &lt;div className=<span class="string">&quot;container&quot;</span> onMouseMove=&#123;<span class="function">(<span class="params">&#123; clientX: x, clientY: y &#125;</span>) =&gt;</span> set(&#123; <span class="attr">xy</span>: calc(x, y) &#125;)&#125;&gt;</span><br><span class="line">            &lt;animated.div className=<span class="string">&quot;card1&quot;</span> style=&#123;&#123; <span class="attr">transform</span>: amimation.xy.interpolate(trans1) &#125;&#125; /&gt;</span><br><span class="line">            &lt;animated.div className=<span class="string">&quot;card2&quot;</span> style=&#123;&#123; <span class="attr">transform</span>: amimation.xy.interpolate(trans2) &#125;&#125; /&gt;</span><br><span class="line">            &lt;animated.div className=<span class="string">&quot;card3&quot;</span> style=&#123;&#123; <span class="attr">transform</span>: amimation.xy.interpolate(trans3) &#125;&#125; /&gt;</span><br><span class="line">            &lt;animated.div className=<span class="string">&quot;card4&quot;</span> style=&#123;&#123; <span class="attr">transform</span>: amimation.xy.interpolate(trans4) &#125;&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.app.css</span><br><span class="line">html,</span><br><span class="line">body,</span><br><span class="line">#app &#123;</span><br><span class="line">  width: <span class="number">100</span>%;</span><br><span class="line">  height: <span class="number">100</span>%;</span><br><span class="line">  margin: <span class="number">0</span>;</span><br><span class="line">  padding: <span class="number">0</span>;</span><br><span class="line">  background-color: white;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  background: #f0f0f0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body &#123;</span><br><span class="line">  font-family: -apple-system, BlinkMacSystemFont, avenir next, avenir, helvetica neue, helvetica, ubuntu,</span><br><span class="line">    roboto, noto, segoe ui, arial, sans-serif;</span><br><span class="line">  background: transparent;</span><br><span class="line">  -webkit-touch-callout: none;</span><br><span class="line">  -webkit-user-select: none;</span><br><span class="line">  -khtml-user-select: none;</span><br><span class="line">  -moz-user-select: none;</span><br><span class="line">  -ms-user-select: none;</span><br><span class="line">  user-select: none;</span><br><span class="line">  cursor: <span class="keyword">default</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.card1,</span><br><span class="line">.card2,</span><br><span class="line">.card3,</span><br><span class="line">.card4 &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  border-radius: <span class="number">5</span>px;</span><br><span class="line">  background-size: cover;</span><br><span class="line">  background-position: center center;</span><br><span class="line">  background-repeat: no-repeat;</span><br><span class="line">  will-change: transform;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.card1 &#123;</span><br><span class="line">  min-width: <span class="number">60</span>ch;</span><br><span class="line">  min-height: <span class="number">60</span>ch;</span><br><span class="line">  width: <span class="number">45</span>vw;</span><br><span class="line">  height: <span class="number">45</span>vw;</span><br><span class="line">  max-width: <span class="number">100</span>ch;</span><br><span class="line">  max-height: <span class="number">100</span>ch;</span><br><span class="line">  background-image: url(https:<span class="comment">//image.flaticon.com/icons/svg/119/119596.svg);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.card2 &#123;</span><br><span class="line">  width: <span class="number">25</span>ch;</span><br><span class="line">  height: <span class="number">25</span>ch;</span><br><span class="line">  background-image: url(https:<span class="comment">//image.flaticon.com/icons/svg/789/789395.svg);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.card3 &#123;</span><br><span class="line">  opacity: <span class="number">0.9</span>;</span><br><span class="line">  width: <span class="number">25</span>ch;</span><br><span class="line">  height: <span class="number">25</span>ch;</span><br><span class="line">  background-image: url(https:<span class="comment">//image.flaticon.com/icons/svg/414/414927.svg);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.card4 &#123;</span><br><span class="line">  width: <span class="number">25</span>ch;</span><br><span class="line">  height: <span class="number">25</span>ch;</span><br><span class="line">  background-image: url(https:<span class="comment">//image.flaticon.com/icons/svg/789/789392.svg);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.container &#123;</span><br><span class="line">  width: <span class="number">100</span>%;</span><br><span class="line">  height: <span class="number">100</span>%;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="1-4-useSprings的用法"><a href="#1-4-useSprings的用法" class="headerlink" title="1.4 useSprings的用法"></a>1.4 useSprings的用法</h3><p>useSpring用来创建一个Spring，useSprings可以用来创建一组Spring，每个Spring都有自己的配置。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSprings, animated &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> items = [<span class="number">0.2</span>, <span class="number">0.4</span>, <span class="number">0.6</span>, <span class="number">0.8</span>, <span class="number">1.0</span>];</span><br><span class="line">    <span class="keyword">const</span> springs = useSprings(<span class="number">5</span>, items.map(<span class="function"><span class="params">item</span> =&gt;</span> (&#123; <span class="attr">from</span>: &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;, <span class="attr">to</span>: &#123; <span class="attr">opacity</span>: item &#125; &#125;)))</span><br><span class="line">    <span class="keyword">return</span> springs.map(<span class="function">(<span class="params">p, idx</span>) =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">animated.div</span> <span class="attr">key</span>=<span class="string">&#123;idx&#125;</span> <span class="attr">style</span>=<span class="string">&#123;p&#125;</span>&gt;</span>哈哈<span class="tag">&lt;/<span class="name">animated.div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<h3 id="1-5-useTrail的用法"><a href="#1-5-useTrail的用法" class="headerlink" title="1.5 useTrail的用法"></a>1.5 useTrail的用法</h3><p>useTrail可以用来创建一组Spring，每个Spring都有相同的配置，每个Spring跟随前一个Spring，在交叉的动画中使用</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useTrail, animated &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//这种写法可以</span></span><br><span class="line">    <span class="comment">//const trail = useTrail(5, &#123;opacity: 1&#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//这种写法也可以</span></span><br><span class="line">    <span class="keyword">const</span> [trail, set, stop] = useTrail(<span class="number">5</span>, <span class="function">() =&gt;</span> (&#123; <span class="attr">opacity</span>: <span class="number">1</span> &#125;))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#123;trail.map((p, idx) =&gt; <span class="tag">&lt;<span class="name">animated.div</span> <span class="attr">key</span>=<span class="string">&#123;idx&#125;</span> <span class="attr">style</span>=<span class="string">&#123;p&#125;</span> &gt;</span>哈哈<span class="tag">&lt;/<span class="name">animated.div</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; set(&#123; opacity: 0 &#125;) &#125;&#125;&gt;点我改变透明度<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<h3 id="1-6-useTransition的用法"><a href="#1-6-useTransition的用法" class="headerlink" title="1.6 useTransition的用法"></a>1.6 useTransition的用法</h3><p>一个动画组，根据items的增加删除移动，会开启对应的动画</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//案例---切换一组数据</span></span><br><span class="line"><span class="keyword">import</span> React,&#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useTransition, animated &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [items, setItems] = useState([&#123;<span class="attr">text</span>:<span class="string">&#x27;zhangsan&#x27;</span>,<span class="attr">key</span>:<span class="number">1</span>&#125;,&#123;<span class="attr">text</span>:<span class="string">&#x27;lisi&#x27;</span>,<span class="attr">key</span>:<span class="number">2</span>&#125;,&#123;<span class="attr">text</span>:<span class="string">&#x27;wangwu&#x27;</span>,<span class="attr">key</span>:<span class="number">3</span>&#125;])</span><br><span class="line">    <span class="keyword">const</span> transitions = useTransition(items, <span class="function"><span class="params">item</span> =&gt;</span> item.key, &#123;</span><br><span class="line">        <span class="keyword">from</span>: &#123; <span class="attr">transform</span>: <span class="string">&#x27;translate3d(0,-40px,0)&#x27;</span> &#125;,</span><br><span class="line">        enter: &#123; <span class="attr">transform</span>: <span class="string">&#x27;translate3d(0,0px,0)&#x27;</span> &#125;,</span><br><span class="line">        leave: &#123; <span class="attr">transform</span>: <span class="string">&#x27;translate3d(0,-40px,0)&#x27;</span> &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(transitions)</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;setItems(state=&gt;[&#123;text:&#x27;zhaoliu&#x27;,key:12&#125;,...state])&#125;&#125;&gt;增加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">            transitions.map((&#123; item, props, key &#125;) =&gt;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">animated.div</span> <span class="attr">key</span>=<span class="string">&#123;key&#125;</span> <span class="attr">style</span>=<span class="string">&#123;props&#125;</span>&gt;</span>&#123;item.text&#125;<span class="tag">&lt;/<span class="name">animated.div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        )</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>) </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//案例---切换组件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useTransition, animated &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [toggle, setToggle] = useState(<span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">const</span> transitions = useTransition(toggle, <span class="literal">null</span>, &#123;</span><br><span class="line">        <span class="keyword">from</span>: &#123; <span class="attr">position</span>: <span class="string">&#x27;absolute&#x27;</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</span><br><span class="line">        enter: &#123; <span class="attr">opacity</span>: <span class="number">1</span> &#125;,</span><br><span class="line">        leave: &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.log(transitions)</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; setToggle(state =&gt; !state) &#125;&#125;&gt;切换<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">            transitions.map((&#123; item, key, props &#125;) =&gt;</span></span><br><span class="line">                &lt;React.Fragment key=&#123;key&#125;&gt;</span><br><span class="line">                    &#123;item &amp;&amp; &lt;animated.div key=&#123;key&#125; style=&#123;props&#125;&gt;切换单个组件&lt;/animated.div&gt;&#125;</span><br><span class="line">                    &#123;/* &#123;item ? &lt;animated.div style=&#123;props&#125;&gt;组件1&lt;/animated.div&gt; : &lt;animated.div style=&#123;props&#125;&gt;组件2&lt;/animated.div&gt;&#125; */&#125;</span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line"><span class="xml">            )</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//案例：切换路由</span></span><br><span class="line">#App.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> About <span class="keyword">from</span> <span class="string">&#x27;@/components2/About&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">&#x27;@/components2/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Search <span class="keyword">from</span> <span class="string">&#x27;@/components2/Search&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; useTransition, animated &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;  Route, Link, Switch,useLocation &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App2 = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> location = useLocation();</span><br><span class="line">    <span class="keyword">const</span> transitions = useTransition(location, <span class="function"><span class="params">location</span> =&gt;</span> location.pathname, &#123;</span><br><span class="line">        <span class="keyword">from</span>: &#123; <span class="attr">position</span>: <span class="string">&#x27;absolute&#x27;</span>, <span class="attr">opacity</span>: <span class="number">0</span>,<span class="attr">transform</span>: <span class="string">&#x27;translate3d(0,-40px,0)&#x27;</span> &#125;,</span><br><span class="line">        enter: &#123; <span class="attr">opacity</span>: <span class="number">1</span>,<span class="attr">transform</span>: <span class="string">&#x27;translate3d(0,0px,0)&#x27;</span> &#125;,</span><br><span class="line">        leave: &#123; <span class="attr">opacity</span>: <span class="number">0</span>,<span class="attr">transform</span>: <span class="string">&#x27;translate3d(0,-40px,0)&#x27;</span> &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;Link to=<span class="string">&quot;/&quot;</span>&gt;来到首页&lt;/Link&gt;</span><br><span class="line">            &lt;Link to=<span class="string">&quot;/about&quot;</span>&gt;来到About&lt;/Link&gt;</span><br><span class="line">            &lt;Link to=<span class="string">&quot;/search&quot;</span>&gt;来到Search&lt;/Link&gt;</span><br><span class="line"></span><br><span class="line">            &#123;transitions.map(<span class="function">(<span class="params">&#123; item, props, key &#125;</span>) =&gt;</span> (</span><br><span class="line">                &lt;animated.div key=&#123;key&#125; style=&#123;props&#125;&gt;</span><br><span class="line">                    &lt;Switch&gt;</span><br><span class="line">                        &lt;Route path=<span class="string">&#x27;/&#x27;</span> exact component=&#123;Home&#125; /&gt;</span><br><span class="line">                        &lt;Route path=<span class="string">&#x27;/about&#x27;</span> component=&#123;About&#125; /&gt;</span><br><span class="line">                        &lt;Route path=<span class="string">&#x27;/search&#x27;</span> strict component=&#123;Search&#125; /&gt;</span><br><span class="line">                    &lt;/Switch&gt;</span><br><span class="line">                &lt;/animated.div&gt;</span><br><span class="line">            ))&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#main.js</span><br><span class="line">ReactDom.render(<span class="xml"><span class="tag">&lt;<span class="name">HashRouter</span>&gt;</span><span class="tag">&lt;<span class="name">App2</span>&gt;</span><span class="tag">&lt;/<span class="name">App2</span>&gt;</span><span class="tag">&lt;/<span class="name">HashRouter</span>&gt;</span></span>,<span class="built_in">document</span>.getElementById(<span class="string">&quot;app&quot;</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//背景轮播图案例</span></span><br><span class="line"></span><br><span class="line">#1.App.jsx</span><br><span class="line"><span class="keyword">import</span> React, &#123; useState,useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useTransition, animated &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./app.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> slides = [</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">url</span>: <span class="string">&#x27;photo-1544511916-0148ccdeb877?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;w=1901&amp;q=80i&#x27;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">url</span>: <span class="string">&#x27;photo-1544572571-ab94fd872ce4?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;w=1534&amp;q=80&#x27;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">url</span>: <span class="string">&#x27;reserve/bnW1TuTV2YGcoh1HyWNQ_IMG_0207.JPG?ixlib=rb-1.2.1&amp;w=1534&amp;q=80&#x27;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">url</span>: <span class="string">&#x27;photo-1540206395-68808572332f?ixlib=rb-1.2.1&amp;w=1181&amp;q=80&#x27;</span> &#125;,</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [index, setIndex] = useState(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">const</span> transitions = useTransition(slides[index], <span class="function"><span class="params">item</span> =&gt;</span> item.id, &#123;</span><br><span class="line">        <span class="keyword">from</span>: &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</span><br><span class="line">        enter: &#123; <span class="attr">opacity</span>: <span class="number">1</span> &#125;,</span><br><span class="line">        leave: &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在hooks中，使用useEffect，可以直接在函数组件内处理生命周期事件。 </span></span><br><span class="line">    <span class="comment">//如果你熟悉 React class 的生命周期函数，你可以把 useEffect Hook 看做 componentDidMount，componentDidUpdate 和 componentWillUnmount 这三个函数的组合</span></span><br><span class="line">    useEffect(<span class="function">() =&gt;</span> <span class="keyword">void</span> <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> setIndex(<span class="function"><span class="params">state</span> =&gt;</span> (state + <span class="number">1</span>) % <span class="number">4</span>), <span class="number">2000</span>), [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">            transitions.map((&#123; item, props, key &#125;) =&gt; (</span></span><br><span class="line">                &lt;animated.div</span><br><span class="line">                    key=&#123;key&#125;</span><br><span class="line">                    className=&quot;bg&quot;</span><br><span class="line">                    style=&#123;&#123; ...props, backgroundImage: `url(https://images.unsplash.com/$&#123;item.url&#125;&amp;auto=format&amp;fit=crop)` &#125;&#125;</span><br><span class="line"><span class="xml">                /&gt;</span></span><br><span class="line"><span class="xml">            ))</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br><span class="line"></span><br><span class="line">#2.app.css</span><br><span class="line"></span><br><span class="line">.App &#123;</span><br><span class="line">    font-family: sans-serif;</span><br><span class="line">    text-align: center;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  .bg &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: <span class="number">0</span>;</span><br><span class="line">    left: <span class="number">0</span>;</span><br><span class="line">    width: <span class="number">100</span>vw;</span><br><span class="line">    height: <span class="number">100</span>vh;</span><br><span class="line">    background-size: cover;</span><br><span class="line">    background-position: center;</span><br><span class="line">    will-change: opacity;</span><br><span class="line">  &#125; </span><br></pre></td></tr></table></figure>

<h3 id="1-7-useChain的用法"><a href="#1-7-useChain的用法" class="headerlink" title="1.7 useChain的用法"></a>1.7 useChain的用法</h3><p>useChain可以让一系列动画沿着一定的序列运行</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The spring will start right away: 0.0 * 1000ms = 0ms</span></span><br><span class="line"><span class="comment">// The transition will start after: 0.5 * 1000ms (the timeFrame default) = 500ms</span></span><br><span class="line">useChain([springRef, transitionRef], [<span class="number">0</span>, <span class="number">0.5</span>]) <span class="comment">/*1000*/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//案例：点击div展开子控件</span></span><br><span class="line">#1.App.jsx</span><br><span class="line"><span class="keyword">import</span> React, &#123; useState, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useTransition, useSpring, useChain, animated &#125; <span class="keyword">from</span> <span class="string">&#x27;react-spring&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./app.css&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> data = [&#123; <span class="attr">name</span>: <span class="number">1</span>, <span class="attr">css</span>: <span class="string">&quot;red&quot;</span> &#125;, &#123; <span class="attr">name</span>: <span class="number">2</span>, <span class="attr">css</span>: <span class="string">&quot;blue&quot;</span> &#125;, &#123; <span class="attr">name</span>: <span class="number">3</span>, <span class="attr">css</span>: <span class="string">&quot;yellow&quot;</span> &#125;, &#123; <span class="attr">name</span>: <span class="number">4</span>, <span class="attr">css</span>: <span class="string">&quot;pink&quot;</span> &#125;];</span><br><span class="line">    <span class="comment">//定义一个open state用于控制窗口是否被打开</span></span><br><span class="line">    <span class="keyword">const</span> [open, setOpen] = useState(<span class="literal">false</span>)</span><br><span class="line">    <span class="comment">//创建一个springRef的引用</span></span><br><span class="line">    <span class="keyword">const</span> springRef = useRef()</span><br><span class="line">    <span class="comment">//创建Spring动画,作用是当open为true的时候，让父盒子变大</span></span><br><span class="line">    <span class="keyword">const</span> &#123; size, background, ...rest &#125; = useSpring(&#123;</span><br><span class="line">        ref: springRef,</span><br><span class="line">        <span class="keyword">from</span>: &#123; <span class="attr">size</span>: <span class="string">&#x27;30%&#x27;</span>, <span class="attr">background</span>: <span class="string">&#x27;hotpink&#x27;</span> &#125;,</span><br><span class="line">        to: &#123; <span class="attr">size</span>: open ? <span class="string">&#x27;100%&#x27;</span> : <span class="string">&#x27;30%&#x27;</span>, <span class="attr">background</span>: open ? <span class="string">&#x27;white&#x27;</span> : <span class="string">&#x27;hotpink&#x27;</span> &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建一个transRef的引用</span></span><br><span class="line">    <span class="keyword">const</span> transRef = useRef()</span><br><span class="line">    <span class="comment">//创建过渡动画(当父盒子打开后，若干子盒子呈现)</span></span><br><span class="line">    <span class="keyword">const</span> transitions = useTransition(open ? data : [], <span class="function"><span class="params">item</span> =&gt;</span> item.name, &#123;</span><br><span class="line">        ref: transRef,</span><br><span class="line">        unique: <span class="literal">true</span>, <span class="comment">//动画进入和离开使用相同的key</span></span><br><span class="line">        trail: <span class="number">400</span>/data.length,  <span class="comment">//动画的延迟时间</span></span><br><span class="line">        <span class="keyword">from</span>: &#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">&#x27;scale(0)&#x27;</span> &#125;,</span><br><span class="line">        enter: &#123; <span class="attr">opacity</span>: <span class="number">1</span>, <span class="attr">transform</span>: <span class="string">&#x27;scale(1)&#x27;</span> &#125;,</span><br><span class="line">        leave: &#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">&#x27;scale(0)&#x27;</span> &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建动画链  当open是true，先执行springRef动画；否则先执行transRef动画</span></span><br><span class="line">    <span class="comment">// 当open为true，0~0.1执行springRef动画，0.1之后执行transRef动画</span></span><br><span class="line">    <span class="comment">// 当open为false，0~0.6执行transRef动画，0.6之后执行springRef动画</span></span><br><span class="line">    useChain(open ? [springRef, transRef] : [transRef, springRef], [<span class="number">0</span>, open ? <span class="number">0.1</span> : <span class="number">0.6</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;animated.div className=<span class="string">&quot;parent&quot;</span> style=&#123;&#123; <span class="attr">width</span>: size, <span class="attr">height</span>: size, background &#125;&#125; onClick=&#123;<span class="function">() =&gt;</span> setOpen(<span class="function"><span class="params">open</span> =&gt;</span> !open)&#125;&gt;</span><br><span class="line">            &#123;transitions.map(<span class="function">(<span class="params">&#123; item, key, props &#125;</span>) =&gt;</span> (</span><br><span class="line">                &lt;animated.div className=<span class="string">&quot;item&quot;</span> key=&#123;key&#125; style=&#123;&#123; ...props, <span class="attr">background</span>: item.css &#125;&#125; /&gt;</span><br><span class="line">            ))&#125;</span><br><span class="line">        &lt;/animated.div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.app.css</span><br><span class="line">html,body,#app&#123;</span><br><span class="line">    width: <span class="number">100</span>%;</span><br><span class="line">    height: <span class="number">100</span>%;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body&#123;</span><br><span class="line">    background: cornflowerblue;</span><br><span class="line">    padding: <span class="number">50</span>px;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.parent&#123;</span><br><span class="line">    margin: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.item&#123;</span><br><span class="line">   width: <span class="number">100</span>px;</span><br><span class="line">   height: <span class="number">100</span>px;</span><br><span class="line">   display: inline-block; </span><br><span class="line">   margin-left: <span class="number">20</span>px;</span><br><span class="line">   margin-top: <span class="number">20</span>px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/11/29/react-spring%E5%8A%A8%E7%94%BB%E5%BA%93/" data-id="ckdzwmbdt001k0wv003s21mq4" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-rn环境搭建" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/14/rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="article-date">
  <time datetime="2019-10-14T09:56:45.000Z" itemprop="datePublished">2019-10-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/react/">react</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/14/rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">rn环境搭建</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-移动App开发环境配置"><a href="#1-移动App开发环境配置" class="headerlink" title="1.移动App开发环境配置"></a>1.移动App开发环境配置</h2><h3 id="1-1-安装最新版本的java-jdk"><a href="#1-1-安装最新版本的java-jdk" class="headerlink" title="1.1 安装最新版本的java jdk"></a>1.1 安装最新版本的java jdk</h3><ol>
<li>修改环境变量，新增<code>JAVA_HOME</code>的系统环境变量，值为<code>C:\Program Files (x86)\Java\jdk1.8.0_112</code>，也就是安装JDK的根目录</li>
<li>修改系统环境变量<code>Path</code>，在<code>Path</code>之后新增<code>%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;</code></li>
<li>新建<strong>系统环境变量</strong><code>CLASSPATH</code>，值为<code>.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;</code></li>
<li>保存所有的系统环境变量，同时退出系统环境变量配置窗口，然后运行cmd命令行工具，输入<code>javac</code>，如果能出现javac的命令选项，就表示配置成功！</li>
</ol>
<h3 id="1-2-安装Node-js环境"><a href="#1-2-安装Node-js环境" class="headerlink" title="1.2 安装Node.js环境"></a>1.2 安装Node.js环境</h3><p>注意：需要安装最新的长期稳定版本，不要实验版本；安装完毕之后的node.js会自动配置到全局系统环境变量中<br>安装完毕后，可以输入<code>node -v</code>查看node版本号；</p>
<h3 id="1-3-安装C-环境"><a href="#1-3-安装C-环境" class="headerlink" title="1.3 安装C++环境"></a>1.3 安装C++环境</h3><p>大多数情况下操作系统自带C++环境，不需要手动安装C++环境；<br>如果运行报错，则需要手动安装visual studio中的C++环境；</p>
<h3 id="1-4-安装Git环境"><a href="#1-4-安装Git环境" class="headerlink" title="1.4 安装Git环境"></a>1.4 安装Git环境</h3><p>Git安装完毕后，会自动配置到系统环境变量中；<br>可以通过运行<code>git --version</code>来检查是否正确安装和配置了Git的环境变量；</p>
<h3 id="1-5-安装Python环境"><a href="#1-5-安装Python环境" class="headerlink" title="1.5 安装Python环境"></a>1.5 安装Python环境</h3><ol>
<li>注意：安装Python时候，只能<strong>安装2.×的版本</strong>，注意勾选安装界面上的<code>Add Python to path</code>，这样才能自动将Python安装到系统环境变量中；</li>
<li>安装完毕之后，可以在命令行中运行<code>python</code>，检查是否成功安装了python。</li>
</ol>
<h3 id="1-6-配置安卓环境"><a href="#1-6-配置安卓环境" class="headerlink" title="1.6 配置安卓环境"></a>1.6 配置安卓环境</h3><h4 id="a-使用已经配好的环境："><a href="#a-使用已经配好的环境：" class="headerlink" title="a) 使用已经配好的环境："></a>a) 使用已经配好的环境：</h4><p>将资料中的android目录解压到c:/android下(已经提前安装好很多软件)</p>
<h4 id="b-安装android-studio配置安卓环境"><a href="#b-安装android-studio配置安卓环境" class="headerlink" title="b) 安装android studio配置安卓环境"></a>b) 安装android studio配置安卓环境</h4><p><a target="_blank" rel="noopener" href="https://reactnative.cn/docs/getting-started.html">https://reactnative.cn/docs/getting-started.html</a></p>
<ol>
<li><p>下载配置android studio</p>
</li>
<li><p>初次启动android studio的时候配置proxy代理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mirrors.neusoft.edu.cn:80</span><br><span class="line">点击clear passwords</span><br></pre></td></tr></table></figure>

<p><img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1562910885243.png" alt="1562910885243"></p>
<p>​</p>
<p><img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1562910917004.png" alt="1562910917004"></p>
<ol>
<li>自定义安装并指定android路径为c:/android目录</li>
</ol>
<p><img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1562906726308.png" alt="1562906726308"></p>
<p><img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1562906929342.png" alt="1562906929342"></p>
<ol>
<li>安装android studio需要的组件</li>
</ol>
<p><img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1562907136464.png" alt="1562907136464"></p>
<p><img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1562907475255.png" alt="1562907475255"></p>
<ol>
<li>在android studio的启动界面选择config下的sdk manager安装android-28</li>
</ol>
</li>
</ol>
<p><img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1562922886367.png" alt="1562922886367"></p>
<h4 id="c-配置安卓环境变量"><a href="#c-配置安卓环境变量" class="headerlink" title="c) 配置安卓环境变量"></a>c) 配置安卓环境变量</h4><p>在系统环境变量中新建<code>ANDROID_HOME</code>，值为android SDK Manager的安装路径<code>C:\android</code>，紧接着，在Path中新增<code>;%ANDROID_HOME%\tools;%ANDROID_HOME%\platform-tools;</code></p>
<h4 id="d-配置gradle"><a href="#d-配置gradle" class="headerlink" title="d) 配置gradle"></a>d) 配置gradle</h4><p>将资料gradle.zip解压到c盘根目录</p>
<p>GRADLE_HOME    C:\gradle-5.6.1\bin</p>
<p>path下新增    ;%GRADLE_HOME%</p>
<h3 id="1-7-安装雷电模拟器"><a href="#1-7-安装雷电模拟器" class="headerlink" title="1.7 安装雷电模拟器"></a>1.7 安装雷电模拟器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.点击夜神模拟器安装包，安装模拟器</span></span><br><span class="line"><span class="number">375</span>*<span class="number">667</span>   dpi:<span class="number">163</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.将C:\android\platform-tools\adb.exe拷贝一份，替换掉雷电模拟器下的adb.exe</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.打开夜神模拟器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//4.使用adb命令连接模拟器</span></span><br><span class="line">adb connect <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5555</span>   /  adb disconnect <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5555</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//5.查看连接到电脑上的设备列表</span></span><br><span class="line">adb devices</span><br></pre></td></tr></table></figure>

<h2 id="2-使用ReactNative快速打包"><a href="#2-使用ReactNative快速打包" class="headerlink" title="2.使用ReactNative快速打包"></a>2.使用ReactNative快速打包</h2><ol>
<li>安装完node后建议<strong>设置npm镜像</strong>以加速后面的过程（或使用科学上网工具）。注意：<strong>不要使用cnpm！</strong>cnpm安装的模块路径比较奇怪，packager不能正常识别！</li>
</ol>
<blockquote>
<p>npm config set registry <a target="_blank" rel="noopener" href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a> –global</p>
<p>npm config set disturl <a target="_blank" rel="noopener" href="https://npm.taobao.org/dist">https://npm.taobao.org/dist</a> –global</p>
<p>如果使用了nrm，要切换到镜像源到taobao，不要使用cnpm</p>
<p>关掉蓝灯等VPN代理</p>
</blockquote>
<ol>
<li>Yarn、React Native的命令行工具（react-native-cli）</li>
</ol>
<ul>
<li><p>Yarn是Facebook提供的替代npm的工具，可以加速node模块的下载(react-native-cli中默认使用yarn来装包的)</p>
<p>React Native的命令行工具用于执行创建、初始化、更新项目、运行打包服务（packager）等任务。</p>
<blockquote>
<p>npm install -g yarn <a href="mailto:&#114;&#x65;&#x61;&#99;&#x74;&#x2d;&#x6e;&#97;&#x74;&#x69;&#x76;&#x65;&#x2d;&#x63;&#108;&#105;&#x40;&#50;&#46;&#x30;&#46;&#x31;">&#114;&#x65;&#x61;&#99;&#x74;&#x2d;&#x6e;&#97;&#x74;&#x69;&#x76;&#x65;&#x2d;&#x63;&#108;&#105;&#x40;&#50;&#46;&#x30;&#46;&#x31;</a></p>
</blockquote>
</li>
<li><p>安装完yarn后同理也要设置镜像源：</p>
<blockquote>
<p>yarn config set registry <a target="_blank" rel="noopener" href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a> –global<br>yarn config set disturl <a target="_blank" rel="noopener" href="https://npm.taobao.org/dist">https://npm.taobao.org/dist</a> –global</p>
</blockquote>
</li>
</ul>
<ol>
<li><p>运行<code>react-native init AwesomeProject</code>创建React-Native项目 (注意：需要确保目录路径没有中文)</p>
</li>
<li><p>运行<code>react-native run-android</code>打包编译安卓项目，并部署到夜神模拟器中</p>
<p><strong>问题1:index.android.bundle</strong></p>
<p><img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/clip_image002.jpg" alt="img"></p>
<p><img src="D:/%E5%89%8D%E7%AB%AF%E5%A4%87%E8%AF%BE/19.%E6%B7%B7%E5%90%88App%E5%BC%80%E5%8F%91/readme/assets/clip_image003.png" alt="img"></p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A)在android&#x2F;app&#x2F;src&#x2F;main下新建assets文件夹</span><br><span class="line"></span><br><span class="line">B)在项目根目录下输入如下命令：</span><br><span class="line">react-native bundle --platform android --dev false --entry-file index.js --bundle-output android&#x2F;app&#x2F;src&#x2F;main&#x2F;assets&#x2F;index.android.bundle --assets-dest android&#x2F;app&#x2F;src&#x2F;main&#x2F;res</span><br><span class="line"></span><br><span class="line">C) 重新使用 react-native run-android 来启动项目</span><br></pre></td></tr></table></figure>

<p>   <strong>问题2：解决热更新的问题(8081端口被java.exe占用的问题)</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A) netstat -ano | findstr &quot;8081&quot;    如果结果显示 java.exe，则说明8081端口被占用了</span><br><span class="line">B) react-native  run-android 把项目安装到夜神模拟器</span><br><span class="line">C) 打开夜神模拟器，打开app，摇一摇，如下图设置端口</span><br><span class="line">D) 关闭调试窗口，然后通过react-native start --port  9999 重新打开服务端口</span><br><span class="line">E) 打开夜神模拟器，摇一摇</span><br></pre></td></tr></table></figure>

<p>   <img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/clip_image002-1575536526795.jpg" alt="img"></p>
<p>   <img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/clip_image004.jpg" alt="img"></p>
<p>   <img src="rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1575536587430.png" alt="1575536587430"></p>
<ol>
<li><p>运行上一条命令之前，要确保有设备连接到了电脑上，可以运行<code>adb devices</code>查看当前接入的设备列表，打包好的文件，放到了<code>android\app\build\outputs\apk</code>目录下</p>
</li>
<li><p>Windows安装mac虚拟机打包ios的ipa</p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5b73d23ae51d45668423842e">https://juejin.im/post/5b73d23ae51d45668423842e</a></p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/14/rn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" data-id="ckdzwmbdh000l0wv04tkfclxl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-nuxt介绍" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/12/nuxt%E4%BB%8B%E7%BB%8D/" class="article-date">
  <time datetime="2019-08-12T07:24:43.000Z" itemprop="datePublished">2019-08-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/vue/">vue</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/12/nuxt%E4%BB%8B%E7%BB%8D/">nuxt介绍</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-Nuxt-js"><a href="#1-Nuxt-js" class="headerlink" title="1.Nuxt.js"></a>1.Nuxt.js</h2><h3 id="1-1-简介"><a href="#1-1-简介" class="headerlink" title="1.1 简介"></a>1.1 简介</h3><p>Nuxt 是一个基于 Vue 生态的更高层的框架，为开发服务端渲染(SSR)的 Vue 应用提供了极其便利的开发体验。</p>
<p>Vue.js是开发SPA单页面应用的，传统的SPA应用是将bundle.js从服务端获取，然后在客户端解析并挂载到dom。</p>
<p>Nuxt这个框架是用Vue开发多页应用，并在服务端渲染。我们可以将组件渲染为服务器端的 HTML 字符串，将它们直接发送到浏览器，最后将这些静态标记”激活”为客户端上完全可交互的应用程序。</p>
<p>Nuxt适合做新闻、博客、电影、咨询这样的需要搜索引擎提供流量的项目。如果你要做到是移动端项目，就没有必要用nuxt这个框架了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Nuxt.js有如下特点：</span><br><span class="line">Vue 2 ： nuxt是基于Vue2开发的</span><br><span class="line">Vue Router  ： nuxt整合了路由功能，配置非常简单</span><br><span class="line">VueX  ： 支持vuex</span><br><span class="line">Vue Server Renderer  ： 支持服务端渲染</span><br><span class="line">Vue-meta  ： 支持meta标签配置</span><br></pre></td></tr></table></figure>

<h3 id="1-2-Nuxt项目创建"><a href="#1-2-Nuxt项目创建" class="headerlink" title="1.2 Nuxt项目创建"></a>1.2 Nuxt项目创建</h3><p><a target="_blank" rel="noopener" href="https://zh.nuxtjs.org/guide/installation#%E6%96%B0%E6%89%8B%E6%A8%A1%E6%9D%BF">https://zh.nuxtjs.org/guide/installation#%E6%96%B0%E6%89%8B%E6%A8%A1%E6%9D%BF</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建nuxt项目   https://www.npmjs.com/package/create-nuxt-app</span></span><br><span class="line">$ npx create-nuxt-app nuxt-learn</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.nuxt模式选择Universal</span></span><br><span class="line">   spa是单页，所以只有一个入口文件，不利于搜索引擎收录</span><br><span class="line">   Universal 通用app，服务器渲染的 Vue.js 应用程序也可以被认为是<span class="string">&quot;同构&quot;</span>或<span class="string">&quot;通用&quot;</span>，因为应用程序的大部分代码都可以在服务器和客户端上运行</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.注意不要选择pretty(会和eslint冲突)</span></span><br><span class="line">    我们都知道，如何与团队其他人高效地进行协作开发是多人团队的一个痛点。</span><br><span class="line">    每个人都有独立的编码习惯，虽然团队可以通过制定强制执行的规范来保持大家代码风格的尽量一致。</span><br><span class="line">    但是，在实际编码过程中，个人可能会不经意地继续使用着自己的代码风格，而等到发现不一致再解决又未免有点迟。</span><br><span class="line">    而ESLint正是为解决这类问题而生的。ESLint 由 JavaScript 红宝书 作者 Nicholas C. Zakas 编写， <span class="number">2013</span> 年发布第一个版本，t是一款当前应用十分广泛的JavaScript代码检查工具</span><br><span class="line">    </span><br><span class="line"><span class="comment">//4.npm run dev</span></span><br><span class="line">   访问  http:<span class="comment">//localhost:3000/</span></span><br></pre></td></tr></table></figure>

<p><img src="nuxt%E4%BB%8B%E7%BB%8D/1545786453223.png" alt="1545786453223"></p>
<p><img src="nuxt%E4%BB%8B%E7%BB%8D/7.png" alt="7"></p>
<h3 id="1-3-Nuxt基本使用"><a href="#1-3-Nuxt基本使用" class="headerlink" title="1.3 Nuxt基本使用"></a>1.3 Nuxt基本使用</h3><h4 id="a-路由"><a href="#a-路由" class="headerlink" title="a) 路由"></a>a) 路由</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//pages文件夹下面，文件名即路由</span></span><br><span class="line"></span><br><span class="line">#1.pages下新建search.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    这是search页面</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.index.vue使用路由</span><br><span class="line">&lt;nuxt-link to=<span class="string">&quot;/search&quot;</span>&gt;到search页面&lt;/nuxt-link&gt;</span><br></pre></td></tr></table></figure>

<h4 id="b-嵌套子模板"><a href="#b-嵌套子模板" class="headerlink" title="b) 嵌套子模板"></a>b) 嵌套子模板</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#index.vue</span><br><span class="line"></span><br><span class="line">#1.template</span><br><span class="line">&lt;template&gt;</span><br><span class="line">      &lt;section <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;container&quot;</span>&gt;</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">              &lt;logo/&gt;</span><br><span class="line">             &lt;/div&gt;</span><br><span class="line">      &lt;/section&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">#2. javascript</span><br><span class="line"><span class="keyword">import</span> Logo <span class="keyword">from</span> <span class="string">&#x27;~/components/Logo.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Logo</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="c-layouts布局文件"><a href="#c-layouts布局文件" class="headerlink" title="c) layouts布局文件"></a>c) layouts布局文件</h4><p>默认情况下所有的页面都会默认使用layouts下面default.vue这个布局文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#default.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;头部&lt;/h1&gt;</span><br><span class="line">    &lt;!--nuxt就相当于 router-view--&gt;</span><br><span class="line">    &lt;nuxt/&gt;                     </span><br><span class="line">    &lt;h1&gt;尾巴&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#自定义布局文件</span><br><span class="line">#1.layouts下新建一个user.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;用户页面头部&lt;/h1&gt;</span><br><span class="line">    &lt;nuxt/&gt;</span><br><span class="line">    &lt;h1&gt;用户页面底部&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=<span class="string">&quot;css&quot;</span> scoped&gt;</span><br><span class="line">  h1&#123;</span><br><span class="line">    color:green</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">#2.pages下的search.vue指定使用哪个布局文件</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    layout:<span class="string">&quot;user&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="d-全局的css文件"><a href="#d-全局的css文件" class="headerlink" title="d) 全局的css文件"></a>d) 全局的css文件</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#1.在assets下新建css/main.css</span><br><span class="line"></span><br><span class="line">#2.修改nuxt.config.css配置文件</span><br><span class="line">css: [</span><br><span class="line">    <span class="string">&#x27;element-ui/lib/theme-chalk/index.css&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;~/assets/css/main.css&#x27;</span></span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">#3.重启服务</span><br></pre></td></tr></table></figure>

<h4 id="e-vuex的使用"><a href="#e-vuex的使用" class="headerlink" title="e) vuex的使用"></a>e) vuex的使用</h4><p>在nuxt中使用vuex的时候无需new Vue.Store实例，nuxt会帮我们自动创建。默认情况下，会使用index.js这个store</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">#1.store/index.js</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  list: [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>],</span><br><span class="line">  user:&#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  increment (state,text) &#123;</span><br><span class="line">    state.list.push(text);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> actions = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#2.store/city.js</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  list: [<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  increment (state,text) &#123;</span><br><span class="line">    state.list.push(text);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#3.pages/city.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    Page is city</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-<span class="keyword">for</span>=<span class="string">&quot;(item,idx) in $store.state.list&quot;</span></span><br><span class="line">        :key=<span class="string">&quot;idx&quot;</span>&gt; &#123;&#123; item &#125;&#125; </span><br><span class="line">       &lt;/li&gt;</span><br><span class="line"></span><br><span class="line">      &lt;input</span><br><span class="line">        type=<span class="string">&quot;button&quot;</span></span><br><span class="line">        value=<span class="string">&quot;增加信息index&quot;</span></span><br><span class="line">        @click=<span class="string">&quot;addIndex&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">      &lt;li</span><br><span class="line">        v-<span class="keyword">for</span>=<span class="string">&quot;(item,idx) in $store.state.city.list&quot;</span></span><br><span class="line">        :key=<span class="string">&quot;idx&quot;</span>&gt; &#123;&#123; item &#125;&#125; </span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">    &lt;input</span><br><span class="line">      type=<span class="string">&quot;button&quot;</span></span><br><span class="line">      value=<span class="string">&quot;增加信息city&quot;</span></span><br><span class="line">      @click=<span class="string">&quot;addCity&quot;</span>&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    data()&#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        list:[]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      addIndex()&#123;</span><br><span class="line">        <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;increment&#x27;</span>, <span class="string">&quot;kk&quot;</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      addCity()&#123;</span><br><span class="line">        <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;city/increment&#x27;</span>, <span class="string">&quot;jj&quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-async和await"><a href="#1-4-async和await" class="headerlink" title="1.4 async和await"></a>1.4 async和await</h3><p>async和await提供了一个很好的框架来编写易于读写的异步代码。有了async/await，我们很少需要写promise.then/catch</p>
<h4 id="1-4-1-async"><a href="#1-4-1-async" class="headerlink" title="1.4.1 async"></a>1.4.1 async</h4><p>函数前面的<code>async</code>一词意味着一个简单的事情：这个函数总是返回一个promise，如果代码中有<code>return &lt;非promise&gt;</code>语句，JavaScript会自动把返回的这个value值包装成promise的resolved值。如果 async 函数没有返回值，它会返回 Promise.resolve(undefined)。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//上面代码和下面代码等效</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//Promise.resolve方法返回一个promise的实例</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//放在一个函数前的async有两个作用：</span></span><br><span class="line"><span class="number">1.</span>使函数总是返回一个promise</span><br><span class="line"><span class="number">2.</span>允许在这其中使用<span class="keyword">await</span></span><br></pre></td></tr></table></figure>

<h4 id="1-4-2-await"><a href="#1-4-2-await" class="headerlink" title="1.4.2 await"></a>1.4.2 await</h4><p>关键词   <code>await</code>可以让JavaScript进行等待，直到一个promise执行并返回它的结果，JavaScript才会继续往下执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(<span class="string">&#x27;done!&#x27;</span>), <span class="number">1000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> promise <span class="comment">// 直到promise返回一个resolve值（*）</span></span><br><span class="line">    alert(result) <span class="comment">// &#x27;done!&#x27; </span></span><br><span class="line">&#125;</span><br><span class="line">f()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//promise前面的await关键字能够使JavaScript等待，直到promise处理结束。然后：</span></span><br><span class="line"><span class="number">1.</span>如果它是一个错误，异常就产生了，就像在那个地方调用了<span class="keyword">throw</span> error一样。可以使用<span class="keyword">try</span> <span class="keyword">catch</span>处理异常</span><br><span class="line"><span class="number">2.</span>否则它会返回一个结果，我们可以将它分配给一个值</span><br></pre></td></tr></table></figure>

<h3 id="1-5-SPA-SEO-SSR"><a href="#1-5-SPA-SEO-SSR" class="headerlink" title="1.5 SPA\SEO\SSR"></a>1.5 SPA\SEO\SSR</h3><h4 id="1-5-1-SPA-单页面应用"><a href="#1-5-1-SPA-单页面应用" class="headerlink" title="1.5.1 SPA:单页面应用"></a>1.5.1 SPA:单页面应用</h4><p>SPA 时代，主要是在客户端端使用了<code>history</code>或<code>hash</code>（主要是为了低版本浏览器的兼容）API，在首次请求经服务端路由输出整个应用程序后，接下来的路由都由前端掌控了，前端通过路由作为中心枢纽控制一系列页面（组件）的渲染(DOM的生成)加载和数据交互。</p>
<blockquote>
<p>优点</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">页面之间的切换非常快</span><br><span class="line">一定程度减少了后端服务器的压力</span><br><span class="line">后端程序只需要提供api，不需要客户端到底是web端还是手机等</span><br></pre></td></tr></table></figure>

<blockquote>
<p>缺点</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">首屏打开速度很慢，因为用户首次加载需要先下载SPA框架及应用程序的代码，然后在客户端渲染页面。</span><br><span class="line">不利于SEO搜索引擎优化</span><br></pre></td></tr></table></figure>

<h4 id="1-5-2-SEO-搜索引擎优化"><a href="#1-5-2-SEO-搜索引擎优化" class="headerlink" title="1.5.2 SEO:搜索引擎优化"></a>1.5.2 SEO:搜索引擎优化</h4><p>SEO是一种通过了解搜索引擎的运作规则（如何抓取网站页面，如何索引以及如何根据特定的关键字展现搜索结果排序等）来调整网站，以提高该网站在搜索引擎中某些关键词的搜索结果排名。</p>
<p>我们之前说SPA单页面应用，通过AJAX获取数据，这就难保证我们的页面能被搜索引擎正常收到，并且有一些搜索引擎不支持执行js和通过ajax获取数据，那就更不用提SEO了。为了解决这个问题，SSR登场了</p>
<h4 id="1-5-3-SSR-服务器端渲染"><a href="#1-5-3-SSR-服务器端渲染" class="headerlink" title="1.5.3 SSR:服务器端渲染"></a>1.5.3 SSR:服务器端渲染</h4><p>为了解决SPA不支持SEO的问题，我们也可以将同一个组件渲染为服务器端的 HTML 字符串，将它们直接发送到浏览器，但是这样的HTML页面还不具备交互能力，所以还需要与SPA框架配合，在浏览器上“混合”成可交互的应用程序。</p>
<p>基本流程是：</p>
<blockquote>
<p>在浏览器第一次访问某个 URI 资源的时候（首屏），Web 服务器根据路由拿到对应数据渲染并输出，且输出的数据中包含两部分：</p>
<ul>
<li>路由页对应的页面及已渲染好的数据</li>
<li>完整的SPA程序代码</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在客户端首屏渲染完成之后，此时我们看到的其实已经是一个和之前的 SPA 相差无几的应用程序了，接下来我们进行的任何操作都只是客户端的应用进行交互，页面&#x2F;组件由Web端渲染，路由也由浏览器控制，用户只需要和当前浏览器内的应用打交道就可以了。</span><br></pre></td></tr></table></figure>

<blockquote>
<p>SSR优点</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">更好的 SEO，由于搜索引擎爬虫抓取工具可以直接查看完全渲染的页面。</span><br><span class="line">更快的内容到达时间(time-to-content)，不用等待所有的JS都下载完成，浏览器便能显示比较完整的页面了</span><br></pre></td></tr></table></figure>

<blockquote>
<p>SSR缺点</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">占用更多的cpu和内存资源</span><br><span class="line">一些常用的浏览器的api可能无法正常使用，比如window，document，alert等，如果使用的话需要对运行环境加以判断</span><br><span class="line">开发调试会有一些麻烦，因为涉及到了浏览器及服务器，对于SPA的一些组件的生命周期的管理会变得复杂</span><br></pre></td></tr></table></figure>

<h4 id="1-5-4-Nuxt对SSR支持"><a href="#1-5-4-Nuxt对SSR支持" class="headerlink" title="1.5.4 Nuxt对SSR支持"></a>1.5.4 Nuxt对SSR支持</h4><p>从头搭建一个服务端渲染的应用是相当复杂的。幸运的是，我们有一个优秀的社区项目 <a target="_blank" rel="noopener" href="https://nuxtjs.org/">Nuxt.js</a> 让这一切变得非常简单。Nuxt 是一个基于 Vue 生态的更高层的框架，为开发服务端渲染的 Vue 应用提供了极其便利的开发体验。</p>
<p>Nuxt.js 是使用 Webpack 和 Node.js 进行封装的基于Vue的SSR框架，预设了利用Vue.js开发<strong>服务端渲染</strong>的应用所需要的各种配置，使用它你可以不需要自己搭建一套 SSR 程序，而是通过其约定好的文件结构和API就可以实现一个首屏渲染的 Web 应用。</p>
<p>Nuxt.js 主要关注的是应用的 UI渲染。</p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/58ff960ba22b9d0065b722cd">https://juejin.im/post/58ff960ba22b9d0065b722cd</a></p>
<h3 id="1-6-数据预取"><a href="#1-6-数据预取" class="headerlink" title="1.6 数据预取"></a>1.6 数据预取</h3><h4 id="1-6-1-准备服务器接口"><a href="#1-6-1-准备服务器接口" class="headerlink" title="1.6.1 准备服务器接口"></a>1.6.1 准备服务器接口</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#1.server/interface/city.js</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> router = express.Router()</span><br><span class="line">router.get(<span class="string">&#x27;/info&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> res.status(<span class="number">200</span>).json([<span class="string">&#x27;北京&#x27;</span>,<span class="string">&#x27;天津&#x27;</span>])</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br><span class="line"></span><br><span class="line">#2.server/index.js</span><br><span class="line"><span class="keyword">const</span> cityInterface = <span class="built_in">require</span>(<span class="string">&quot;./interface/city&quot;</span>)</span><br><span class="line"><span class="comment">//在app.use(nuxt.render)上面添加app.use(&quot;/city&quot;,cityInterface)</span></span><br><span class="line">app.use(<span class="string">&quot;/city&quot;</span>,cityInterface);</span><br><span class="line">app.use(nuxt.render)</span><br><span class="line"></span><br><span class="line">#.重启服务</span><br><span class="line">  localhost:<span class="number">3000</span>/city/info  测试接口</span><br></pre></td></tr></table></figure>

<h4 id="1-6-2-不使用数据预取"><a href="#1-6-2-不使用数据预取" class="headerlink" title="1.6.2 不使用数据预取"></a>1.6.2 不使用数据预取</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#1.客户端pages下新建city.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    Page is city</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-<span class="keyword">for</span>=<span class="string">&quot;(item,idx) in list&quot;</span></span><br><span class="line">        :key=<span class="string">&quot;idx&quot;</span>&gt; &#123;&#123; item &#125;&#125; &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    data()&#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        list:[]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//async表示方法返回一个Promise</span></span><br><span class="line">    <span class="comment">//await 同步等待</span></span><br><span class="line">    <span class="keyword">async</span> mounted()&#123;</span><br><span class="line">      <span class="keyword">let</span> &#123;status,data&#125; = <span class="keyword">await</span> axios.get(<span class="string">&quot;/city/info&quot;</span>);</span><br><span class="line">      <span class="built_in">this</span>.list = data;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.list);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="1-6-3-Nuxt-js工作流"><a href="#1-6-3-Nuxt-js工作流" class="headerlink" title="1.6.3 Nuxt.js工作流"></a>1.6.3 Nuxt.js工作流</h4><p><img src="nuxt%E4%BB%8B%E7%BB%8D/1546049173524.png" alt="1546049173524"></p>
<blockquote>
<p>nuxtServerInit：如果在状态树(store)中指定了 <code>nuxtServerInit</code> 方法，Nuxt.js 调用它的时候会将页面的上下文对象作为第2个参数传给它（仅在服务端调用）。当我们想将服务端的一些数据传到客户端时，这个方法是非常好用的  </p>
<p>middleware：中间件允许您定义一个自定义函数运行在一个页面或一组页面渲染之前，服务端首屏渲染和路由跳转前均执行对应中间件。可以用作页面跳转时验证用户信息操作(登陆拦截)。</p>
<p>asyncData会在组件加载前（限于页面组件）调用，可以在<strong>服务端首屏渲染或者在路由跳转时执行</strong>，专门用来请求数据，Nuxt.js 会将 <code>asyncData</code> 返回的数据融合组件 <code>data</code> 方法返回的数据一并返回给当前组件。asyncData应该是用于影响SEO的内容，也就是需要让爬虫读取的内容。</p>
</blockquote>
<h4 id="1-6-4-服务端数据预取"><a href="#1-6-4-服务端数据预取" class="headerlink" title="1.6.4 服务端数据预取"></a>1.6.4 服务端数据预取</h4><h5 id="a-nuxtServerInit"><a href="#a-nuxtServerInit" class="headerlink" title="a)  nuxtServerInit"></a>a)  nuxtServerInit</h5><p>nuxtServerInit可以将服务端的数据通过vuex同步到客户端，该方法仅会在服务端首屏渲染时执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#store/index.js</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  list: [],</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  setlist (state,text) &#123;</span><br><span class="line">    text.forEach(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span><br><span class="line">      state.list.push(item)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">//将菜单信息写入到vuex实例中</span></span><br><span class="line">  <span class="keyword">async</span> nuxtServerInit (&#123; commit &#125;, &#123; req ,app &#125;) &#123;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">let</span> &#123;status, data&#125; = <span class="keyword">await</span> app.$axios.get(<span class="string">&quot;/city/info&quot;</span>);</span><br><span class="line">      commit(<span class="string">&#x27;setlist&#x27;</span>, data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#2.pages/city.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    Page is city</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-<span class="keyword">for</span>=<span class="string">&quot;(item,idx) in $store.state.list&quot;</span></span><br><span class="line">        :key=<span class="string">&quot;idx&quot;</span>&gt; &#123;&#123; item &#125;&#125; &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h5 id="b-asyncData和fetch方法"><a href="#b-asyncData和fetch方法" class="headerlink" title="b) asyncData和fetch方法"></a>b) asyncData和fetch方法</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用asyncData进行ssr渲染</span></span><br><span class="line"><span class="keyword">async</span> asyncData()&#123;</span><br><span class="line">    <span class="comment">//给data取别名，请求网址写全，因为在刷新浏览器的时候需要全路径请求服务器</span></span><br><span class="line">    <span class="keyword">let</span> &#123;status,<span class="attr">data</span>:list&#125; = <span class="keyword">await</span> axios.get(<span class="string">&quot;http://127.0.0.1:3000/city/info&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(status == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="comment">//这边不能使用this.list = list,因为获取不到this</span></span><br><span class="line">        <span class="comment">//通过return给页面返回数据</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            list</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> fetch (&#123; store, params &#125;)&#123;</span><br><span class="line">      <span class="comment">//当页面加载时触发可以执行请求来触发action来修改state</span></span><br><span class="line">      <span class="comment">//不可以return数据给页面</span></span><br><span class="line">      <span class="comment">//页面可以从this.$store中获取action修改的state</span></span><br><span class="line">      <span class="keyword">let</span> &#123;status,<span class="attr">data</span>:list&#125; = <span class="keyword">await</span> axios.get(<span class="string">&quot;http://127.0.0.1:3000/city/info&quot;</span>);</span><br><span class="line">      store.commit(<span class="string">&#x27;setlist&#x27;</span>, list)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#注意点：asyncData 和 fetch都只能够在页面组件中使用，如果想要在页面组件的子组件中使用ssr，可以使用nuxtServerInit</span><br><span class="line">#注意点：由于 asyncData方法是在组件初始化前被调用的，所以在方法内是没有办法通过this来引用组件的实例。</span><br><span class="line">#注意点：当用户请求页面时候服务端会先使用SSR来生成对应的页面文档结构，而在用户切换路由则是使用了SPA的模式。这意味着如果用户刷新页面，asyncData方法会在服务端执行；如果用户通过nuxt-link路由导航到当前页面，asyncData会在客户端执行</span><br></pre></td></tr></table></figure>

<blockquote>
<hr>
</blockquote>
<h4 id="1-6-5-客户端数据预取"><a href="#1-6-5-客户端数据预取" class="headerlink" title="1.6.5 客户端数据预取"></a>1.6.5 客户端数据预取</h4><p>当asyncData方法是由路由跳转触发的时候，则使用客户端数据预取，asyncData方法会在客户端执行。可以通过控制台打印来查看是在浏览器执行还是在node执行就可以验证了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//https://zh.nuxtjs.org/api/#asyncdata-%E6%96%B9%E6%B3%95</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> asyncData(context)&#123;</span><br><span class="line">    <span class="comment">//给data取别名，请求网址写全</span></span><br><span class="line">    <span class="keyword">let</span> &#123;status,<span class="attr">data</span>:list&#125; = <span class="keyword">await</span> axios.get(<span class="string">&quot;http://127.0.0.1:3000/city/info&quot;</span>);</span><br><span class="line">    <span class="comment">//如果是客户端执行，则可以使用window对象</span></span><br><span class="line">    <span class="comment">//如果是服务端执行，则没有window对象</span></span><br><span class="line">    <span class="keyword">if</span>(process.client)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">window</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(status == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="comment">//这边不能使用this.list = list,因为获取不到this</span></span><br><span class="line">        <span class="comment">//通过return给页面返回数据</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            list</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-7-SSR原理"><a href="#1-7-SSR原理" class="headerlink" title="1.7 SSR原理"></a>1.7 SSR原理</h3><p><img src="nuxt%E4%BB%8B%E7%BB%8D/92672015b4914784ae5a800c4a655e25.jpeg" alt="img"></p>
<p><strong>官方文档</strong>:<a target="_blank" rel="noopener" href="https://ssr.vuejs.org/zh/">https://ssr.vuejs.org/zh/</a></p>
<p>如上图所示：webpack将 Source 打包出两个bundle文件。</p>
<p>服务端渲染：Server Bundle用于服务端渲染，主要是获取异步数据，同步到组件中，并将组件渲染成HTML返回到前端，但是<strong>vue-ssr不能绑定javascript事件</strong>，也就是说服务器端使用vue-ssr渲染出来的返回到浏览器的也只能是HTML+CSS。</p>
<p>客户端渲染：Client Bundle 用于客户端渲染，之前说过服务器不能增加事件，那只能前端增加。所以我们看到SSR渲染的网页源码中有<code>window.__NUXT__=...</code>代码，这是后端和前端在使用vuex共享数据。后端从vuex里面取到数据之后渲染成真正的HTML和css返回。客户端也是从vuex里面取到数据，客户端的渲染主要做2件事：</p>
<blockquote>
<p>1.拿到数据，使用    virtual-dom进行预渲染，然后和服务端渲染出来的进行比对，比对两边渲染的内容是不是一致的</p>
<p>2.对DOM元素的事件进行绑定，也就是回答的问题，事件在这块进行的处理</p>
</blockquote>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/12/nuxt%E4%BB%8B%E7%BB%8D/" data-id="ckdzwmbds001j0wv0h36cdoop" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-formik和yup" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/29/formik%E5%92%8Cyup/" class="article-date">
  <time datetime="2019-06-29T13:08:09.000Z" itemprop="datePublished">2019-06-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/react/">react</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/29/formik%E5%92%8Cyup/">formik和yup</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-formik-yup"><a href="#1-formik-yup" class="headerlink" title="1.formik+yup"></a>1.formik+yup</h1><p>formik文档</p>
<p><a target="_blank" rel="noopener" href="https://jaredpalmer.com/formik/docs/api/formik#props">https://jaredpalmer.com/formik/docs/api/formik#props</a></p>
<p>yup文档</p>
<p><a target="_blank" rel="noopener" href="https://github.com/jquense/yup#yup">https://github.com/jquense/yup#yup</a></p>
<p>表单操作在React中一直是一件比较繁琐的事情，使用formik可以极大的简化表单操作，formik的slogan就是 Build forms in React, without the tears 😭 </p>
<h2 id="1-1-formik介绍"><a href="#1-1-formik介绍" class="headerlink" title="1.1 formik介绍"></a>1.1 formik介绍</h2><p>当我们想要访问表单中的input控件的值时，通常有两种操作，一种是使用ref去得到dom结构，第二种是使用state存储value。首先，针对于第一种情况，虽然使用ref能够让我们很方便的获取到dom节点，进而获取input的值，但是需要注意的是当我们在使用React的时候，我们需要时刻告诉自己，不要直接操作dom！不要直接操作dom！不要直接操作dom！官方也是不推荐该做法的； 对于第二种做法，虽然这是官方推荐的做法，当时由于绑定了state，所以form表单中的控件也变成了受控组件，如果我们想真正改动其数据，我们往往需要再绑定一个onChange事件，当控件过多时，操作也是非常繁琐的。</p>
<p>而formik的出现，将表单操作化繁为简，使得表单操作变得非常的简单。formik不仅提供了针对的表单的状态管理，还能很方便的对表单做规则校验。其实formik的原理很简单：它内置了表单的state管理操作，无需我们在单独为表单建立state，同时使用了Context，能够让表单组件多层嵌套，不再需要我们一层层传递。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>npm</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install formik --save</span><br></pre></td></tr></table></figure>

<p>要么</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add formik</span><br></pre></td></tr></table></figure>

<p>Formik与React v15 +兼容，并与ReactDOM和React Native一起使用。</p>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p> <img src="https://upload-images.jianshu.io/upload_images/10769576-f46a2b762c50bf87.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500/format/webp" alt="img"> </p>
<p>我们该表单作为例子，表单包含了姓名，性别，年龄三个字段，一个提交按钮，给定表单规则如下：</p>
<ul>
<li>姓名（name）: 必填非空</li>
<li>性别（gender）: 必选非空</li>
<li>年龄（age）:必填非空，大于0的整数</li>
</ul>
<p>formik提供了一个名为<code>Formik</code>的组件，组件包含了initialValues，validate,onSubmit,render等props（不限于此，列举出来的只是当前用到的关键的props，完整结构详解Formik API，下面解释一个各个prop作用：</p>
<ul>
<li>initialValues：初始化表单的数据</li>
<li>validate：表单规则校验，返回一个错误信息的对象</li>
<li>onSubmit: 获得表单各个字段，自定义自己的业务操作</li>
<li>render: 表单内部的children组件</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Formik &#125; <span class="keyword">from</span> <span class="string">&#x27;formik&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BasicExample = <span class="function">() =&gt;</span> (</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;My Form&lt;/h1&gt;</span><br><span class="line">    &lt;Formik</span><br><span class="line">      initialValues=&#123;&#123; <span class="attr">name</span>: <span class="string">&#x27;jared&#x27;</span> &#125;&#125;</span><br><span class="line">      onSubmit=&#123;<span class="function">(<span class="params">values, actions</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          alert(<span class="built_in">JSON</span>.stringify(values, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line">          actions.setSubmitting(<span class="literal">false</span>);</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">      &#125;&#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &#123;<span class="function"><span class="params">props</span> =&gt;</span> (</span><br><span class="line">        &lt;form onSubmit=&#123;props.handleSubmit&#125;&gt;</span><br><span class="line">          &lt;input</span><br><span class="line">            type=<span class="string">&quot;text&quot;</span></span><br><span class="line">            onChange=&#123;props.handleChange&#125;</span><br><span class="line">            onBlur=&#123;props.handleBlur&#125;</span><br><span class="line">            value=&#123;props.values.name&#125;</span><br><span class="line">            name=<span class="string">&quot;name&quot;</span></span><br><span class="line">          /&gt;</span><br><span class="line">          &#123;props.errors.name &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;feedback&quot;</span>&gt;</span>&#123;props.errors.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;</span><br><span class="line">          &lt;button type=<span class="string">&quot;submit&quot;</span>&gt;Submit&lt;/button&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">      )&#125;</span><br><span class="line">    &lt;/Formik&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>针对内部的表单，render方法会传入一个props，props包括了values，errors，handleSubmit，handleChange，handleBlur等属性（更详细的内容参见<a target="_blank" rel="noopener" href="https://jaredpalmer.com/formik/docs/api/formik#dirty-boolean">完整props</a>，其中：</p>
<ul>
<li>values：对应的就是表单各项数据</li>
<li>errors：validate所返回的表单校验后的错误信息</li>
<li>touched：表示表单内的控件是否已经被操作过</li>
<li>handleSubmit：是表单触发提交事件后的formik对提交流程处理事件，规则校验就在其中</li>
<li>handleChane: 更改表单数据的事件</li>
<li>handleBlur: 控件失去焦点后的操作事件，会进行对表单进行规则校验的流程</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;Formik</span><br><span class="line">          initialValues=&#123;&#123;</span><br><span class="line">            name: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            gender: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            age: <span class="string">&quot;&quot;</span></span><br><span class="line">          &#125;&#125;</span><br><span class="line">          validate=&#123;<span class="function"><span class="params">values</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> errors = &#123;&#125;;</span><br><span class="line">            <span class="keyword">if</span> (values.name.length === <span class="number">0</span>) &#123;</span><br><span class="line">              errors.name = <span class="string">&quot;Name can not be empty&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (values.gender.length === <span class="number">0</span>) &#123;</span><br><span class="line">              errors.gender = <span class="string">&quot;You must choose a gender&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (values.age &lt;= <span class="number">0</span> || values.age % <span class="number">1</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">              errors.age = <span class="string">&quot;Age must be a Positive Integer&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> errors;</span><br><span class="line">          &#125;&#125;</span><br><span class="line">          onSubmit=&#123;<span class="function">(<span class="params">values</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(values)</span><br><span class="line">          &#125;&#125;</span><br><span class="line">          render=&#123;<span class="function"><span class="params">props</span> =&gt;</span></span><br><span class="line">            &lt;form onSubmit=&#123;props.handleSubmit&#125;&gt;</span><br><span class="line">              &lt;div className=<span class="string">&quot;content&quot;</span>&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                  &lt;label&gt;姓名： &lt;/label&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;name&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&#123;props.values.name&#125;</span></span></span></span><br><span class="line"><span class="xml">                                            onChange=&#123;props.handleChange&#125; onBlur=&#123;props.handleBlur&#125;/&gt;</span></span><br><span class="line">&#123;props.touched.name &amp;&amp; props.errors.name &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.errors.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                  &lt;label&gt;性别： &lt;/label&gt;</span><br><span class="line">                  &lt;input type=<span class="string">&quot;radio&quot;</span> id=<span class="string">&quot;male&quot;</span> value=<span class="string">&quot;male&quot;</span> name=<span class="string">&quot;gender&quot;</span> onChange=&#123;props.handleChange&#125;</span><br><span class="line">                         onBlur=&#123;props.handleBlur&#125;/&gt; <span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&quot;male&quot;</span>&gt;</span>男<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">                  &lt;input type=<span class="string">&quot;radio&quot;</span> id=<span class="string">&quot;female&quot;</span> value=<span class="string">&quot;female&quot;</span> name=<span class="string">&quot;gender&quot;</span> onChange=&#123;props.handleChange&#125;</span><br><span class="line">                         onBlur=&#123;props.handleBlur&#125;/&gt; <span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&quot;female&quot;</span>&gt;</span>女<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">&#123;props.touched.gender &amp;&amp; props.errors.gender &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.errors.gender&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                  &lt;label&gt;年龄： &lt;/label&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">id</span>=<span class="string">&quot;age&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&#123;props.values.age&#125;</span></span></span></span><br><span class="line"><span class="xml">                                            onChange=&#123;props.handleChange&#125; onBlur=&#123;props.handleBlur&#125;/&gt;</span></span><br><span class="line">&#123;props.touched.age &amp;&amp; props.errors.age &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.errors.age&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div className=<span class="string">&quot;submit-area&quot;</span>&gt;</span><br><span class="line">                  &lt;button type=<span class="string">&quot;submit&quot;</span>&gt;提交&lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">          &#125;</span><br><span class="line">        /&gt;</span><br></pre></td></tr></table></figure>

<p>但是我们依旧可以看出在每一个输入控件的地方，都重复的绑定了onChange，onBlur等事件，并且每个输入错误信息的方式都是很重复的，这显得有点累赘。但是好在formik提交了Form，Field，ErrorMessage等封装好的组件，用于减少重复的工作，代码如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;Formik</span><br><span class="line">          ......</span><br><span class="line">        <span class="comment">//same as before</span></span><br><span class="line">          render=&#123;<span class="function"><span class="params">props</span> =&gt;</span></span><br><span class="line">            &lt;Form&gt;</span><br><span class="line">              &lt;div className=<span class="string">&quot;content&quot;</span>&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                  &lt;label&gt;姓名： &lt;<span class="regexp">/label&gt;&lt;Field name=&quot;name&quot;/</span>&gt;</span><br><span class="line">&lt;ErrorMessage name=<span class="string">&quot;name&quot;</span>/&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                  &lt;label&gt;性别： &lt;/label&gt;</span><br><span class="line">                  &lt;Field name=<span class="string">&quot;gender&quot;</span> render=&#123;<span class="function">(<span class="params">&#123;field&#125;</span>) =&gt;</span></span><br><span class="line">                    &lt;input type=<span class="string">&quot;radio&quot;</span> name=&#123;field.name&#125; value=<span class="string">&quot;male&quot;</span> checked=&#123;field.value === <span class="string">&quot;male&quot;</span>&#125;</span><br><span class="line">                           onChange=&#123;field.onChange&#125;</span><br><span class="line">                           onBlur=&#123;field.onBlur&#125;/&gt;</span><br><span class="line">                  &#125;/&gt;</span><br><span class="line">                  &lt;label htmlFor=<span class="string">&quot;male&quot;</span>&gt;男&lt;/label&gt;</span><br><span class="line">                  &lt;Field name=<span class="string">&quot;gender&quot;</span> render=&#123;<span class="function">(<span class="params">&#123;field&#125;</span>) =&gt;</span></span><br><span class="line">                    &lt;input type=<span class="string">&quot;radio&quot;</span> name=&#123;field.name&#125; value=<span class="string">&quot;female&quot;</span> checked=&#123;field.value === <span class="string">&quot;female&quot;</span>&#125;</span><br><span class="line">                           onChange=&#123;field.onChange&#125;</span><br><span class="line">                           onBlur=&#123;field.onBlur&#125;/&gt;</span><br><span class="line">                  &#125;/&gt; <span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&quot;female&quot;</span>&gt;</span>女<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">&lt;ErrorMessage name=<span class="string">&quot;gender&quot;</span>/&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                  &lt;label&gt;年龄： &lt;<span class="regexp">/label&gt;&lt;Field name=&quot;age&quot;/</span>&gt;</span><br><span class="line">&lt;ErrorMessage name=<span class="string">&quot;age&quot;</span>/&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div className=<span class="string">&quot;submit-area&quot;</span>&gt;</span><br><span class="line">                  &lt;button type=<span class="string">&quot;submit&quot;</span>&gt;提交&lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/Form&gt;</span><br><span class="line">          &#125;</span><br><span class="line">        /&gt;</span><br></pre></td></tr></table></figure>

<p>可以看出，使用formik提供的组件还能进一步简化代码，通过对比可以看出，Form组件想到与form加上onSubmit；ErrorMessage组件就是将touched,errors等一系列判断包裹了起来；Field组件则是封装了onChange，onBlur，value等属性，需要注意的是对于radio，checkbox，select等控件需要单独做一些特殊处理，通常使用其render方法来自定义，除此之外，因为有了render方法，使得Field也能很好的和其他的第三方封装的控件结合。</p>
<p> 此外，formik针对数组类型属性也有很好的支持，现在让我们在表单里面加一个字段，表单样式如下： </p>
<p> <img src="https://upload-images.jianshu.io/upload_images/10769576-49fa1d42d3cb6b7b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/520/format/webp" alt="img"> </p>
<p>我们为表单添加了一个addresses字段，它是一个存储地址的数据，它的验证规则是至少有一个非空的字段。</p>
<p>formik提供了一个FieldArray的组件专门处理数组类型字段，代码如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;Formik</span><br><span class="line">          initialValues=&#123;&#123;</span><br><span class="line">            name: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            gender: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            age: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            addresses: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">          &#125;&#125;</span><br><span class="line">          validate=&#123;<span class="function"><span class="params">values</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> errors = &#123;&#125;;</span><br><span class="line">            <span class="keyword">if</span> (values.name.length === <span class="number">0</span>) &#123;</span><br><span class="line">              errors.name = <span class="string">&quot;Name can not be empty&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (values.gender.length === <span class="number">0</span>) &#123;</span><br><span class="line">              errors.gender = <span class="string">&quot;You must choose a gender&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (values.age &lt;= <span class="number">0</span> || values.age % <span class="number">1</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">              errors.age = <span class="string">&quot;Age must be a Positive Integer&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> addresses = values.addresses.filter(<span class="function"><span class="params">address</span> =&gt;</span> address.trim() !== <span class="string">&quot;&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (addresses.length === <span class="number">0</span>) &#123;</span><br><span class="line">              errors.addresses = <span class="string">&quot;Addresses must have 1 address at least&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> errors;</span><br><span class="line">          &#125;&#125;</span><br><span class="line">       </span><br><span class="line">          onSubmit=&#123;<span class="function">(<span class="params">values</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(values)</span><br><span class="line">          &#125;&#125;</span><br><span class="line">          render=&#123;<span class="function"><span class="params">props</span> =&gt;</span></span><br><span class="line">            &lt;Form&gt;</span><br><span class="line">              &lt;div className=<span class="string">&quot;content&quot;</span>&gt;</span><br><span class="line">              ......</span><br><span class="line">               <span class="comment">// same as before</span></span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                  &lt;label&gt;地址： &lt;/label&gt;</span><br><span class="line">                  &lt;FieldArray name=<span class="string">&quot;addresses&quot;</span> render=&#123;<span class="function"><span class="params">arrayHelper</span> =&gt;</span></span><br><span class="line">                    &lt;div&gt;</span><br><span class="line">                      &#123;props.values.addresses.map(<span class="function">(<span class="params">address, index</span>) =&gt;</span></span><br><span class="line">                        &lt;div className=<span class="string">&quot;address&quot;</span>&gt;</span><br><span class="line">                          &lt;Field name=&#123;<span class="string">`addresses.<span class="subst">$&#123;index&#125;</span>`</span>&#125;/&gt;</span><br><span class="line">                          &lt;div className=<span class="string">&quot;address_add&quot;</span> onClick=&#123;<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                            arrayHelper.push(<span class="string">&quot;&quot;</span>)</span><br><span class="line">                          &#125;&#125;&gt;+</span><br><span class="line">                          &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                      )&#125;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                  &#125;/&gt;</span><br><span class="line">                  &lt;ErrorMessage name=<span class="string">&quot;addresses&quot;</span> component=<span class="string">&quot;div&quot;</span> className=<span class="string">&quot;error&quot;</span>/&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div className=<span class="string">&quot;submit-area&quot;</span>&gt;</span><br><span class="line">                  &lt;button type=<span class="string">&quot;submit&quot;</span>&gt;提交&lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">           &lt;/Form&gt;</span><br><span class="line">          &#125;</span><br><span class="line">        /&gt;</span><br></pre></td></tr></table></figure>

<p>可以看到，使用FieldArray时，它会提供一个arrayHelper的参数，我们可以通过arrayHelper很方便去操作数组的数组，如push，pop等等（更详细的参见<a target="_blank" rel="noopener" href="https://jaredpalmer.com/formik/docs/api/fieldarray#fieldarray-helpers">完整arrayHelper API</a>）</p>
<p>到此为止，就是formik的基本功能的介绍了。</p>
<h2 id="1-2-注入Yup"><a href="#1-2-注入Yup" class="headerlink" title="1.2 注入Yup"></a>1.2 注入Yup</h2><p>虽然formik已经极大的方便了表单的操作，但是我们还是可以看到在做表单验证的时候，写的代码还是比较繁琐，这个时候就需要yup出场了，yup的专长就是做规则校验。并且聪明的formik作者在设计formik的时候就让其很好的支持yup了。</p>
<p> yup的官方介绍：<code>Yup is a JavaScript object schema validator and object parser.</code> </p>
<h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -S yup</span><br></pre></td></tr></table></figure>

<p>Yup总是依赖Promise全局对象来处理异步值以及Set和Map。对于不支持这些功能的浏览器，需要包含polyfill，例如core js：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &#39;core-js&#x2F;es6&#x2F;promise&#39;;</span><br><span class="line">import &#39;core-js&#x2F;es6&#x2F;set&#39;;</span><br><span class="line">import &#39;core-js&#x2F;es6&#x2F;map&#39;;</span><br></pre></td></tr></table></figure>

<p>如果使用TypeScript，建议安装Yup类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D @types&#x2F;yup</span><br></pre></td></tr></table></figure>

<p> 在Formik组件里有一个名为validationSchema的prop，这个就是为yup留出的接口。</p>
<h3 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> yup <span class="keyword">from</span> <span class="string">&#x27;yup&#x27;</span>; <span class="comment">// for everything</span></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//没有yup的情况</span></span><br><span class="line">&lt;Formik</span><br><span class="line">          validate=&#123;<span class="function"><span class="params">values</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> errors = &#123;&#125;;</span><br><span class="line">            <span class="keyword">if</span> (values.name.length === <span class="number">0</span>) &#123;</span><br><span class="line">              errors.name = <span class="string">&quot;Name can not be empty&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (values.gender.length === <span class="number">0</span>) &#123;</span><br><span class="line">              errors.gender = <span class="string">&quot;You must choose a gender&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (values.age &lt;= <span class="number">0</span> || values.age % <span class="number">1</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">              errors.age = <span class="string">&quot;Age must be a Positive Integer&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> addresses = values.addresses.filter(<span class="function"><span class="params">address</span> =&gt;</span> address.trim() !== <span class="string">&quot;&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (addresses.length === <span class="number">0</span>) &#123;</span><br><span class="line">              errors.addresses = <span class="string">&quot;Addresses must have 1 address at least&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> errors;</span><br><span class="line">          &#125;&#125;</span><br><span class="line">       <span class="comment">//......</span></span><br><span class="line">        /&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用yup的情况</span></span><br><span class="line"> &lt;Formik</span><br><span class="line">          validationSchema=&#123;Yup.object().shape(&#123;</span><br><span class="line">            name: Yup.string().trim().required(<span class="string">&quot;Name can not be empty&quot;</span>),</span><br><span class="line">            gender: Yup.string().required(<span class="string">&quot;You must choose a gender&quot;</span>),</span><br><span class="line">            age: Yup.number().moreThan(<span class="number">0</span>, <span class="string">&quot;Age must be greater than 0&quot;</span>).integer(<span class="string">&quot;Age must be a integer&quot;</span>),</span><br><span class="line">            addresses: Yup.array().compact().min(<span class="number">1</span>, <span class="string">&quot;Addresses must have 1 address at least&quot;</span>)</span><br><span class="line">          &#125;)&#125;</span><br><span class="line">      <span class="comment">//......</span></span><br><span class="line">       /&gt;</span><br></pre></td></tr></table></figure>

<p>可以看到使用Yup后，不管是从代码量，还是可读性来看都提交了很多，尤其是在表单非常复杂时，这之间的优化会非常的明显。</p>
<p>可以看到Yup的操作非常的语义化，所以学习成本非常的低，你只需要知道它的api，就能很轻易的使用它，所以对Yup的使用不再赘述，详细信息参见Yup文档。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/29/formik%E5%92%8Cyup/" data-id="ckdzwmbd800040wv0ez795hu1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-rn中的手势系统" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/28/rn%E4%B8%AD%E7%9A%84%E6%89%8B%E5%8A%BF%E7%B3%BB%E7%BB%9F/" class="article-date">
  <time datetime="2019-06-28T08:23:06.000Z" itemprop="datePublished">2019-06-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/react/">react</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/28/rn%E4%B8%AD%E7%9A%84%E6%89%8B%E5%8A%BF%E7%B3%BB%E7%BB%9F/">rn中的手势系统</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>移动设备上的手势识别要比在web上复杂得多。用户的一次触摸操作的真实意图是什么，App要经过好几个阶段才能判断。比如App需要判断用户的触摸到底是在滚动页面，还是滑动一个widget，或者只是一个单纯的点击。甚至随着持续时间的不同，这些操作还会转化。此外，还有多点同时触控的情况。</p>
<p> 触摸响应系统可以使组件在不关心父组件或子组件的前提下自行处理触摸交互。</p>
<h2 id="手势组件"><a href="#手势组件" class="headerlink" title="手势组件"></a>手势组件</h2><h3 id="react-native中预置的处理手势的组件"><a href="#react-native中预置的处理手势的组件" class="headerlink" title="react-native中预置的处理手势的组件"></a>react-native中预置的处理手势的组件</h3><p> react-native中是没有click等事件的，需要借助封装的好的组件配合（<code>onpress</code> 或`onLongPress）完成手势处理</p>
<p>组件：</p>
<ul>
<li><code>TouchableHighlight</code> 触摸屏幕会有高亮显示</li>
<li><code>TouchableNativeFeedback</code> 触摸屏幕会有水波纹效果（仅限Android）</li>
<li><code>TouchableOpacity</code> 触摸屏幕改变当前元素的透明度</li>
<li><code>TouchableWithoutFeedback</code> 触摸屏幕无任何效果</li>
</ul>
<p>事件：</p>
<ul>
<li><code>onPress</code> 点击组件时触发</li>
<li><code>onLongPress</code> 长按组件时触发</li>
</ul>
<h2 id="手势系统"><a href="#手势系统" class="headerlink" title="手势系统"></a>手势系统</h2><p> 单单依靠单击和长按是无法满足移动App多种手势的需求的，此时需要利用收拾系统。</p>
<ul>
<li><p>引入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123; PanResponder &#125; from &quot;react-native&quot;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置手势</p>
<ul>
<li>处理函数：<ul>
<li><code>onStartShouldSetPanResponder</code> 用户开始触摸屏幕的时候，是否愿意成为响应者；默认返回false，无法响应，当返回true的时候则可以进行之后的事件传递。默认为false</li>
<li><code>onMoveShouldSetPanResponder</code> 在每一个触摸点开始移动的时候，再询问一次是否响应触摸交互；认为false</li>
<li><code>onPanResponderGrant</code> 开始手势操作，也可以说按下去。给用户一些视觉反馈，让他们知道发生了什么事情！（如：可以修改颜色）</li>
<li><code>onPanResponderMove</code> 最近一次的移动距离.如:(获取x轴y轴方向的移动距离 <code>gestureState.dx,gestureState.dy</code>)</li>
<li><code>onPanResponderRelease</code> 用户放开了所有的触摸点，且此时视图已经成为了响应者。</li>
<li><code>onPanResponderTerminate</code> 另一个组件已经成为了新的响应者，所以当前手势将被取消。</li>
</ul>
</li>
<li>参数<ul>
<li>evt<ul>
<li>nativeEvent<ul>
<li><code>changedTouches</code> - 在上一次事件之后，所有发生变化的触摸事件的数组集合（即上一次事件后，所有移动过的触摸点）</li>
<li><code>identifier</code> - 触摸点的ID</li>
<li><code>locationX</code> - 触摸点相对于父元素的横坐标</li>
<li><code>locationY</code> - 触摸点相对于父元素的纵坐标</li>
<li><code>pageX</code> - 触摸点相对于根元素的横坐标</li>
<li><code>pageY</code> - 触摸点相对于根元素的纵坐标</li>
<li><code>target</code> - 触摸点所在的元素ID</li>
<li><code>timestamp</code> - 触摸事件的时间戳，可用于移动速度的计算</li>
<li><code>touches</code> - 当前屏幕上的所有触摸点的集合</li>
</ul>
</li>
<li>gestureState<ul>
<li><code>dx/dy</code> - 手势进行到现在的横向/纵向相对位移</li>
<li><code>vx/vy</code> - 此刻的横向/纵向速度</li>
<li><code>numberActiveTouches</code> - responder上的触摸的个数</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 一般来说 手势的创建放在  componentWillMount  生命周期中</span><br><span class="line">componentWillMount(evt, gestureState) &#123;</span><br><span class="line">    &#x2F;&#x2F; 手势创建</span><br><span class="line">    this._panResponder &#x3D; PanResponder.create(&#123;</span><br><span class="line">        onStartShouldSetPanResponder:  (evt, gestureState) &#x3D;&gt; true,</span><br><span class="line">        onMoveShouldSetPanResponder:   (evt, gestureState) &#x3D;&gt; true,</span><br><span class="line">        onPanResponderGrant: (evt, gestureState) &#x3D;&gt; &#123;</span><br><span class="line">            &#x2F;&#x2F;onStartShouldSetPanResponder为true时立即执行</span><br><span class="line">        &#125;,</span><br><span class="line">        onPanResponderMove: (evt, gestureState) &#x3D;&gt; &#123;&#125;,</span><br><span class="line">        onPanResponderRelease: (evt, gestureState) &#x3D;&gt; &#123;&#125;</span><br><span class="line">        onPanResponderTerminate: (evt, gestureState) &#x3D;&gt; &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">    return &lt;View &#123;...this.panResponder.panHandlers&#125;&#125; &gt;&lt;&#x2F;View&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="使用手势系统实现图片拖拽"><a href="#使用手势系统实现图片拖拽" class="headerlink" title="使用手势系统实现图片拖拽"></a>使用手势系统实现图片拖拽</h2><h3 id="1、实现长按-释放改变图片样式"><a href="#1、实现长按-释放改变图片样式" class="headerlink" title="1、实现长按/释放改变图片样式"></a>1、实现长按/释放改变图片样式</h3><ol>
<li><p>声明一个状态控制变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">this.state &#x3D; &#123;</span><br><span class="line">    &#x2F;&#x2F;是否开始拖动</span><br><span class="line">    isMove: false</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置手势系统</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">componentWillMount(evt, gestureState) &#123;</span><br><span class="line">  let self &#x3D; this;</span><br><span class="line">  &#x2F;&#x2F;手势创建</span><br><span class="line">  this._panResponder &#x3D; PanResponder.create(&#123;</span><br><span class="line">    onStartShouldSetPanResponder: (evt, gestureState) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F;当长按1秒之后使得isMove为真，开启拖拽状态</span><br><span class="line">      window.homeTimer &#x3D; setTimeout(()&#x3D;&gt;&#123;</span><br><span class="line">        console.warn(&#39;定时开启&#39;);</span><br><span class="line">        self.setState((state)&#x3D;&gt;&#123;</span><br><span class="line">          return&#123;</span><br><span class="line">           isMove: true</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,1000);</span><br><span class="line">      return true;</span><br><span class="line">    &#125;,</span><br><span class="line">    onMoveShouldSetPanResponder: (evt, gestureState) &#x3D;&gt; true,</span><br><span class="line">    onPanResponderGrant: (evt, gestureState) &#x3D;&gt; &#123;&#125;,</span><br><span class="line">    onPanResponderMove: (evt, gestureState) &#x3D;&gt; &#123;</span><br><span class="line">      if(self.state.isMove)&#123;</span><br><span class="line">        console.warn(&#39;正在移动&#39;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    onPanResponderRelease: (evt, gestureState) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F;释放时，立刻清除定时器，使isMove不为真</span><br><span class="line">      clearTimeout(window.homeTimer);</span><br><span class="line">      &#x2F;&#x2F;开启拖拽状态后，释放时关闭拖拽状态</span><br><span class="line">      self.setState((state)&#x3D;&gt;&#123;</span><br><span class="line">        return&#123;</span><br><span class="line">         isMove: false</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ol>
<ol>
<li><p>利用<code>this.state.isMove</code>来控制图片状态</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   render() &#123;</span><br><span class="line">       return (</span><br><span class="line">           &lt;View style&#x3D;&#123;styles.root&#125;&gt;</span><br><span class="line">               &lt;View &#123;...this._panResponder.panHandlers&#125; ref&#x3D;&#39;refImage&#39; style&#x3D;&#123;this.state.isMove ? styles.moveView : styles.noMoveView&#125;&gt;</span><br><span class="line">                   &lt;Image style&#x3D;&#123;&#123;width: &#39;100%&#39;,height: &#39;100%&#39;&#125;&#125; source&#x3D;&#123;require(&#39;..&#x2F;..&#x2F;assets&#x2F;images&#x2F;test.png&#39;)&#125;&gt;&lt;&#x2F;Image&gt;</span><br><span class="line">               &lt;&#x2F;View&gt;</span><br><span class="line">           &lt;&#x2F;View&gt;</span><br><span class="line">       );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const styles &#x3D; StyleSheet.create(&#123;</span><br><span class="line">  noMoveView: &#123;</span><br><span class="line">    width: 200,</span><br><span class="line">    height: 200,</span><br><span class="line">  &#125;,</span><br><span class="line">  noMoveView: &#123;</span><br><span class="line">    width: 200,</span><br><span class="line">    height: 200,</span><br><span class="line">    &#x2F;*绝对定位后，可使其脱离文档流，通过控制left，top来达到移动的效果*&#x2F;</span><br><span class="line">    position: &#39;absolute&#39;,</span><br><span class="line">    left: 0,</span><br><span class="line">    top: 0,</span><br><span class="line">    zIndex: 999</span><br><span class="line"> &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>效果：</p>
<h3 id="2、实现图片移动跟随"><a href="#2、实现图片移动跟随" class="headerlink" title="2、实现图片移动跟随"></a>2、实现图片移动跟随</h3><ol>
<li><p>在手指触碰到屏幕时，记录当前触碰位置（在<code>onPanResponderGrant</code>中记录）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">onPanResponderGrant: (evt, gestureState) &#x3D;&gt; &#123;</span><br><span class="line">    &#x2F;&#x2F; pageY是相对于根节点的位置，locationY是相对于元素自己</span><br><span class="line">    const &#123; pageX, pageY, locationY, locationX &#125; &#x3D; evt.nativeEvent;</span><br><span class="line">    &#x2F;&#x2F; 保存当前正确点击元素的位置，为了后面移动元素</span><br><span class="line">    this.preY &#x3D; pageY - locationY;   </span><br><span class="line">    &#x2F;&#x2F; 保存当前正确点击元素的位置，为了后面移动元素</span><br><span class="line">    this.preX &#x3D; pageX - locationX;   </span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>移动时实时改变当前元素绝对定位的<code>left</code>和<code>top</code>属性值（在<code>onPanResponderMove</code>中改变）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">onPanResponderMove: (evt, gestureState) &#x3D;&gt; &#123;</span><br><span class="line">    &#x2F;&#x2F;若处于移动状态下</span><br><span class="line">    if (self.state.isMove) &#123;</span><br><span class="line">        let top &#x3D; this.preY + gestureState.dy;</span><br><span class="line">        let left &#x3D; this.preX + gestureState.dx;</span><br><span class="line">        &#x2F;&#x2F;获取当前操作对象元素</span><br><span class="line">        let item &#x3D; this.refs.refImage;</span><br><span class="line">        &#x2F;&#x2F;设置样式</span><br><span class="line">        item.setNativeProps(&#123;</span><br><span class="line">            style: &#123; top: top, left: left &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="3、实时监控图片位置，当满足位置条件并且手指离开屏幕时触发方法"><a href="#3、实时监控图片位置，当满足位置条件并且手指离开屏幕时触发方法" class="headerlink" title="3、实时监控图片位置，当满足位置条件并且手指离开屏幕时触发方法"></a>3、实时监控图片位置，当满足位置条件并且手指离开屏幕时触发方法</h3><p>（<code>onPanResponderRelease</code>）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">onPanResponderRelease: (evt, gestureState) &#x3D;&gt; &#123;</span><br><span class="line">    clearTimeout(window.homeTimer);</span><br><span class="line">    self.setState((state) &#x3D;&gt; &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            isMove: false</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>React-Native中的手势系统</p>
<p> 优点：功能强大，可以借助此工具完成多指手指，滑动退出等功能</p>
<p>缺点：无法确定是哪一个元素触发事件，当点击某元素时，是无法直接获取该元素，需要通过手动计算得到</p>
<h2 id="我的疑问"><a href="#我的疑问" class="headerlink" title="我的疑问"></a>我的疑问</h2><p>在手势系统中的通过<code>evt.nativeEvent.target</code>拿到的id值有何作用？</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/28/rn%E4%B8%AD%E7%9A%84%E6%89%8B%E5%8A%BF%E7%B3%BB%E7%BB%9F/" data-id="ckdzwmbdf000h0wv0dk2pdj9k" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-react组件通信" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/26/react%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/" class="article-date">
  <time datetime="2019-06-26T13:29:55.000Z" itemprop="datePublished">2019-06-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/react/">react</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/26/react%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/">react组件通信</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-1-父子组件的通信"><a href="#1-1-父子组件的通信" class="headerlink" title="1.1 父子组件的通信"></a>1.1 父子组件的通信</h2><h3 id="a-父组件传递给子组件"><a href="#a-父组件传递给子组件" class="headerlink" title="a) 父组件传递给子组件"></a>a) 父组件传递给子组件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line">&lt;CMTItem key=&#123;i&#125; &#123;...item&#125;&lt;/CMTItem&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//子组件通过this.props可以获取到父组件传递过来的数据</span></span><br></pre></td></tr></table></figure>

<h3 id="b-子组件传递给父组件"><a href="#b-子组件传递给父组件" class="headerlink" title="b) 子组件传递给父组件"></a>b) 子组件传递给父组件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line"> &lt;CMTBox reload=&#123;<span class="built_in">this</span>.loadCmts&#125;&gt;&lt;/CMTBox&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//子组件通过this.props.reload() 来调用父组件的方法，调用的时候可以传递参数</span></span><br></pre></td></tr></table></figure>

<h2 id="1-2-使用Context实现跨组件通信"><a href="#1-2-使用Context实现跨组件通信" class="headerlink" title="1.2 使用Context实现跨组件通信"></a>1.2 使用Context实现跨组件通信</h2><p>当你不想在组件树中通过逐层传递 <code>props</code>或者<code>state</code>的方式来传递数据时，可以使用<code>Context</code>来实现<strong>跨层级</strong>的组件数据传递。</p>
<h3 id="a-父子组件传递数据的方式"><a href="#a-父子组件传递数据的方式" class="headerlink" title="a) 父子组件传递数据的方式"></a>a) 父子组件传递数据的方式</h3><p><img src="react%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/1553135155547.png" alt="1553135155547"></p>
<h3 id="b-使用Context跨级传递数据"><a href="#b-使用Context跨级传递数据" class="headerlink" title="b) 使用Context跨级传递数据"></a>b) 使用Context跨级传递数据</h3><p><img src="react%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/1553135231745.png" alt="1553135231745"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个Context对象</span></span><br><span class="line"><span class="keyword">const</span> ThemeContext = React.createContext(<span class="string">&quot;light&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ContextComp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="built_in">super</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">//ThemeContext.Provider 数据的提供者，允许消费组件订阅context的变化</span></span><br><span class="line">        <span class="comment">//value就是给子组件暴露的数据</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">ThemeContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;name:</span>&quot;<span class="attr">zhangsan</span>&quot;&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">ThemedButton</span>&gt;</span><span class="tag">&lt;/<span class="name">ThemedButton</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">ThemeContext.Provider</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThemedButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">//这能让你使用 this.context 来消费最近 Context 上的那个值</span></span><br><span class="line">    <span class="keyword">static</span> contextType = ThemeContext;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Content</span>&gt;</span><span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span>&gt;</span>&#123;this.context.name&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ThemeContext.Consumer 允许我们在函数组件中使用Context</span></span><br><span class="line"><span class="comment">//ThemeContext.Consumer中的箭头函数的入参就是最近一个Provider所暴露的数据</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Content</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">ThemeContext.Consumer</span>&gt;</span>&#123;</span></span><br><span class="line"><span class="xml">        obj =&gt; &#123;</span></span><br><span class="line"><span class="xml">            return <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;obj.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;<span class="tag">&lt;/<span class="name">ThemeContext.Consumer</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-3-使用自定义事件实现组件通讯"><a href="#1-3-使用自定义事件实现组件通讯" class="headerlink" title="1.3 使用自定义事件实现组件通讯"></a>1.3 使用自定义事件实现组件通讯</h2><p>在没有嵌套关系的组件中，我们可以使用自定义事件的方式实现组件通信。</p>
<blockquote>
<p>1.在componentDidMount事件中，订阅事件</p>
<p>2.在组件卸载的时候，在componentWillUnmount事件中取消事件的订阅;</p>
<p>3.以常用的发布/订阅模式，借用Node.js Events模块的浏览器版实现</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install events --save</span><br></pre></td></tr></table></figure>

<p>在src下新建一个util目录里面建一个events.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; EventEmitter &#125; <span class="keyword">from</span> <span class="string">&#x27;events&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> EventEmitter();</span><br></pre></td></tr></table></figure>

<p>list1.jsx</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">&#x27;../util/events&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="built_in">super</span>(props);</span><br><span class="line">        <span class="built_in">this</span>.state = &#123;</span><br><span class="line">            message: <span class="string">&#x27;List1&#x27;</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        <span class="comment">// 组件装载完成以后声明一个自定义事件</span></span><br><span class="line">        <span class="built_in">this</span>.eventEmitter = emitter.addListener(<span class="string">&#x27;changeMessage&#x27;</span>, <span class="function">(<span class="params">message</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.setState(&#123;</span><br><span class="line">                message,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillUnmount() &#123;</span><br><span class="line">        emitter.removeListener(<span class="built_in">this</span>.eventEmitter);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &#123;<span class="built_in">this</span>.state.message&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> List;</span><br></pre></td></tr></table></figure>

<p>List2.jsx</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">&#x27;../util/events&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List2</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    handleClick = <span class="function">(<span class="params">message</span>) =&gt;</span> &#123;</span><br><span class="line">        emitter.emit(<span class="string">&#x27;changeMessage&#x27;</span>, message);</span><br><span class="line">    &#125;;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123;<span class="built_in">this</span>.handleClick.bind(<span class="built_in">this</span>, <span class="string">&#x27;List2&#x27;</span>)&#125;&gt;点击我改变List1组件中显示信息&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>App.jsx</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> List1 <span class="keyword">from</span> <span class="string">&#x27;./components/List1&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> List2 <span class="keyword">from</span> <span class="string">&#x27;./components/List2&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;List1 /&gt;</span><br><span class="line">                &lt;List2 /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自定义事件是典型的发布订阅模式,通过向事件对象上添加监听器和触发事件来实现组件之间的通信</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/26/react%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/" data-id="ckdzwmbdg000j0wv07rtncyve" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vue样式穿透" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/02/vue%E6%A0%B7%E5%BC%8F%E7%A9%BF%E9%80%8F/" class="article-date">
  <time datetime="2019-05-02T04:41:06.000Z" itemprop="datePublished">2019-05-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/vue/">vue</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/02/vue%E6%A0%B7%E5%BC%8F%E7%A9%BF%E9%80%8F/">vue样式穿透</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-什么是scoped"><a href="#1-什么是scoped" class="headerlink" title="1.什么是scoped"></a>1.什么是scoped</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在Vue文件中的style标签上有一个特殊的属性，scoped。当一个style标签拥有scoped属性时候，它的css样式只能用于当前的Vue组件，可以使组件的样式不相互污染。如果一个项目的所有style标签都加上了scoped属性，相当于实现了样式的模块化。</span><br></pre></td></tr></table></figure>

<h2 id="2-scoped的实现原理"><a href="#2-scoped的实现原理" class="headerlink" title="2.scoped的实现原理"></a>2.scoped的实现原理</h2><p>Vue中的scoped属性的效果主要是通过PostCss实现的。以下是转译前的代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;style scoped lang&#x3D;&quot;less&quot;&gt;</span><br><span class="line">    .example&#123;</span><br><span class="line">        color:red;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;example&quot;&gt;scoped测试案例&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<p>转译后:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.example[data-v-5558831a] &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;example&quot; data-v-5558831a&gt;scoped测试案例&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<p>既:PostCSS给一个组件中的所有dom添加了一个独一无二的动态属性，给css选择器额外添加一个对应的属性选择器，来选择组件中的dom,这种做法使得样式只作用于含有该属性的dom元素(组件内部的dom)。</p>
<blockquote>
<p>总结：scoped的渲染规则：</p>
</blockquote>
<ol>
<li>给HTML的dom节点添加一个不重复的data属性(例如: data-v-5558831a)来唯一标识这个dom 元素</li>
<li>在每句css选择器的末尾(编译后生成的css语句)加一个当前组件的data属性选择器(例如：[data-v-5558831a])来私有化样式</li>
</ol>
<h2 id="3-scoped穿透"><a href="#3-scoped穿透" class="headerlink" title="3.scoped穿透"></a>3.scoped穿透</h2><p>scoped看起来很好用，当时在Vue项目中，当我们引入第三方组件库时(如使用vue-awesome-swiper实现移动端轮播)，需要在局部组件中修改第三方组件库的样式，而又不想去除scoped属性造成组件之间的样式覆盖。这时我们可以通过特殊的方式穿透scoped。</p>
<blockquote>
<p>stylus的样式穿透 使用&gt;&gt;&gt;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> 外层 &gt;&gt;&gt; 第三方组件 </span><br><span class="line">     样式</span><br><span class="line">     </span><br><span class="line">.wrapper &gt;&gt;&gt; .swiper-pagination-bullet-active</span><br><span class="line"> background: #fff</span><br></pre></td></tr></table></figure>

<blockquote>
<p>sass和less的样式穿透 使用/deep/</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">外层 &#x2F;deep&#x2F; 第三方组件 &#123;</span><br><span class="line">    样式</span><br><span class="line">&#125;</span><br><span class="line">.wrapper &#x2F;deep&#x2F; .swiper-pagination-bullet-active&#123;</span><br><span class="line">  background: #fff;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-在组件中修改第三方组件库样式的其它方法"><a href="#3-在组件中修改第三方组件库样式的其它方法" class="headerlink" title="3.在组件中修改第三方组件库样式的其它方法"></a>3.在组件中修改第三方组件库样式的其它方法</h2><p>上面我们介绍了在使用scoped 属性时，通过scopd穿透的方式修改引入第三方组件库样式的方法，下面我们介绍其它方式来修改引入第三方组件库的样式</p>
<blockquote>
<p>在vue组件中不使用scoped属性</p>
</blockquote>
<hr>
<blockquote>
<p>在vue组建中使用两个style标签，一个加上scoped属性，一个不加scoped属性，把需要覆盖的css样式写在不加scoped属性的style标签里</p>
</blockquote>
<hr>
<blockquote>
<p>建立一个reset.css(基础全局样式)文件，里面写覆盖的css样式，在入口文件main.js 中引入</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/05/02/vue%E6%A0%B7%E5%BC%8F%E7%A9%BF%E9%80%8F/" data-id="ckdzwmbdj000u0wv0cxlogwl5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-正则表达式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/22/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="article-date">
  <time datetime="2019-04-22T11:26:15.000Z" itemprop="datePublished">2019-04-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/22/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-正则表达式简介"><a href="#1-正则表达式简介" class="headerlink" title="1. 正则表达式简介"></a>1. 正则表达式简介</h2><h3 id="1-1-什么是正则表达式"><a href="#1-1-什么是正则表达式" class="headerlink" title="1.1 什么是正则表达式"></a>1.1 什么是正则表达式</h3><p>正则表达式：用于匹配规律规则的表达式，正则表达式最初是科学家对人类神经系统的工作原理的早期研究，现在在编程语言中有广泛的应用。正则表通常被用来检索、替换那些符合某个模式(规则)的文本。<br>正则表达式是对字符串操作的一种逻辑公式，就是用事先定义好的一些特定字符、及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。</p>
<h3 id="1-2-正则表达式的作用"><a href="#1-2-正则表达式的作用" class="headerlink" title="1.2 正则表达式的作用"></a>1.2 正则表达式的作用</h3><ol>
<li>给定的字符串是否符合正则表达式的过滤逻辑(匹配)</li>
<li>可以通过正则表达式，从字符串中获取我们想要的特定部分(提取)</li>
<li>强大的字符串替换能力(替换)</li>
</ol>
<h3 id="1-3-正则表达式的特点"><a href="#1-3-正则表达式的特点" class="headerlink" title="1.3 正则表达式的特点"></a>1.3 正则表达式的特点</h3><ol>
<li>灵活性、逻辑性和功能性非常的强</li>
<li>可以迅速地用极简单的方式达到字符串的复杂控制</li>
<li>对于刚接触的人来说，比较晦涩难懂</li>
</ol>
<h3 id="1-4-正则表达式的测试"><a href="#1-4-正则表达式的测试" class="headerlink" title="1.4 正则表达式的测试"></a>1.4 正则表达式的测试</h3><ul>
<li><p><a target="_blank" rel="noopener" href="https://c.runoob.com/front-end/854">在线测试正则</a></p>
</li>
<li><p>工具中使用正则表达式</p>
<ul>
<li><p>sublime/vscode/word</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sublime调试正则</span></span><br><span class="line"><span class="number">1</span>、按command+F(windows:ctrl+f)调出查找面板</span><br><span class="line"><span class="number">2</span>、点击上图中最左侧的『.*』开启正则模式；</span><br><span class="line"><span class="number">3</span>、在查找输入框输入正则匹配的模式（.*）部分即是正则表达式部分</span><br></pre></td></tr></table></figure>
</li>
<li><p>演示替换所有的数字</p>
</li>
</ul>
</li>
</ul>
<h3 id="1-5-正则表达式的组成"><a href="#1-5-正则表达式的组成" class="headerlink" title="1.5 正则表达式的组成"></a>1.5 正则表达式的组成</h3><ul>
<li>普通字符</li>
<li>特殊字符(元字符)：正则表达式中有特殊意义的字符</li>
</ul>
<p>示例演示：</p>
<ul>
<li><code>\d</code> 匹配数字</li>
<li><code>ab\d</code> 匹配 ab1、ab2</li>
</ul>
<h3 id="1-6-元字符串"><a href="#1-6-元字符串" class="headerlink" title="1.6 元字符串"></a>1.6 元字符串</h3><p>通过测试工具演示下面元字符的使用</p>
<h4 id="1-6-1-常用元字符串"><a href="#1-6-1-常用元字符串" class="headerlink" title="1.6.1 常用元字符串"></a>1.6.1 常用元字符串</h4><p>元字符：除了\n之外的其他任意字符</p>
<table>
<thead>
<tr>
<th>元字符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>\d</td>
<td>匹配数字</td>
</tr>
<tr>
<td>\D</td>
<td>匹配任意非数字的字符</td>
</tr>
<tr>
<td>\w</td>
<td>匹配字母或数字或下划线</td>
</tr>
<tr>
<td>\W</td>
<td>匹配任意不是字母，数字，下划线</td>
</tr>
<tr>
<td>\s</td>
<td>匹配任意的空白符</td>
</tr>
<tr>
<td>\S</td>
<td>匹配任意不是空白符的字符</td>
</tr>
<tr>
<td>.</td>
<td>匹配除换行符以外的任意单个字符</td>
</tr>
<tr>
<td>^</td>
<td>表示匹配行首的文本(以谁开始)</td>
</tr>
<tr>
<td>$</td>
<td>表示匹配行尾的文本(以谁结束)</td>
</tr>
<tr>
<td>\b</td>
<td>表示单词边界匹配符   what are you</td>
</tr>
</tbody></table>
<h4 id="1-6-2-限定符"><a href="#1-6-2-限定符" class="headerlink" title="1.6.2 限定符"></a>1.6.2 限定符</h4><table>
<thead>
<tr>
<th>限定符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>重复零次或更多次</td>
</tr>
<tr>
<td>+</td>
<td>重复一次或更多次</td>
</tr>
<tr>
<td>?</td>
<td>重复零次或一次</td>
</tr>
<tr>
<td>{n}</td>
<td>重复n次</td>
</tr>
<tr>
<td>{n,}</td>
<td>重复n次或更多次</td>
</tr>
<tr>
<td>{n,m}</td>
<td>重复n到m次</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//限定符:限定前面的表达式出现的次数</span></span><br><span class="line">*    表示的是:前面的表达式出现了<span class="number">0</span>次到多次</span><br><span class="line">[a-z][<span class="number">0</span><span class="number">-9</span>]*  小写字母中的任意一个,后面是要么是没有数字的,要么是多个数字的</span><br><span class="line"></span><br><span class="line">+    表示的是:前面的表达式出现了<span class="number">1</span>次到多次</span><br><span class="line">[a-z][<span class="number">9</span>]+    小写字母一个后面最少一个<span class="number">9</span>,或者多个<span class="number">9</span></span><br><span class="line"></span><br><span class="line">?    表示的是:前面的表达式出现了<span class="number">0</span>次到<span class="number">1</span>次,最少是<span class="number">0</span>次,最多<span class="number">1</span>次 。另一个含义:阻止贪婪模式</span><br><span class="line">[<span class="number">4</span>][a-z]?    <span class="number">4</span>后面可以出现a~z，也可以没有</span><br><span class="line"></span><br><span class="line">n&#123;<span class="number">0</span>,&#125; 表示的是n出现了<span class="number">0</span>次到多次,和*一样的</span><br><span class="line">n&#123;<span class="number">1</span>,&#125; 表示的是n出现了<span class="number">1</span>次到多次,和 +一样的</span><br><span class="line">n&#123;<span class="number">0</span>,<span class="number">1</span>&#125; 表示的是n出现了<span class="number">0</span>次到<span class="number">1</span>次,和 ?一样的</span><br><span class="line">n&#123;<span class="number">5</span>,<span class="number">10</span>&#125; 表示的是前面的n出现了<span class="number">5</span>次到<span class="number">10</span>次</span><br><span class="line">n&#123;<span class="number">4</span>&#125;  表示n出现了<span class="number">4</span>次</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span><span class="number">-7</span>] 表示的是<span class="number">1</span>到<span class="number">7</span>之间的任意的一个数字</span><br><span class="line">[a-z] 表示的是:所有的小写的字母中的任意的一个</span><br><span class="line">[A-Z] 表示的是:所有的大写的字母中的任意的一个</span><br><span class="line">[a-zA-Z] 表示的是:所有的字母的任意的一个</span><br><span class="line">[<span class="number">0</span><span class="number">-9</span>a-zA-Z] 表示的是: 所有的数字或者是字母中的一个</span><br><span class="line">[\u4e00-\u9fa5]  匹配汉字</span><br><span class="line"></span><br><span class="line">^ 表示的是以什么开始,或者是取非(取反) </span><br><span class="line">^[<span class="number">0</span><span class="number">-9</span>] 以数字开头</span><br><span class="line">^[a-z] 以小写字母开始</span><br><span class="line">[^<span class="number">0</span><span class="number">-9</span>] 取反,非数字</span><br><span class="line">[^a-z] 非小写字母</span><br><span class="line">[^<span class="number">0</span><span class="number">-9</span>a-zA-Z_] 不再<span class="number">0</span>到<span class="number">9</span> a到z A到Z之间</span><br><span class="line"></span><br><span class="line">$ 表示的是以什么结束   [<span class="number">0</span><span class="number">-9</span>][a-z]$  必须以小写字母结束</span><br></pre></td></tr></table></figure>

<h4 id="1-6-3-其它"><a href="#1-6-3-其它" class="headerlink" title="1.6.3 其它"></a>1.6.3 其它</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\  转义符</span><br><span class="line">|  或者。选择两者中的一个。注意|将左右两边分为两部分，而不管左右两边有多长多乱。</span><br><span class="line">        [0-9]|[a-z] 表示的是要么是一个数字,要么是一个小写的字母</span><br><span class="line">() 分组。[0-9]|([a-z])|[A-Z]         gr(a|e)y匹配gray和grey</span><br><span class="line">        ([0-9])([1-5])([a-z]) 三组, 从最左边开始计算</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="2-JavaScript-中使用正则表达式"><a href="#2-JavaScript-中使用正则表达式" class="headerlink" title="2. JavaScript 中使用正则表达式"></a>2. JavaScript 中使用正则表达式</h2><h3 id="2-1-创建正则对象"><a href="#2-1-创建正则对象" class="headerlink" title="2.1 创建正则对象"></a>2.1 创建正则对象</h3><p>方式1：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&#x27;\d&#x27;</span>, <span class="string">&#x27;i&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&#x27;\d&#x27;</span>, <span class="string">&#x27;gi&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>方式2：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/\d/i</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/\d/gi</span>;</span><br></pre></td></tr></table></figure>

<p>参数</p>
<table>
<thead>
<tr>
<th>标志</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>i</td>
<td>忽略大小写</td>
</tr>
<tr>
<td>g</td>
<td>全局匹配</td>
</tr>
<tr>
<td>gi</td>
<td>全局匹配+忽略大小写</td>
</tr>
</tbody></table>
<h3 id="2-2-正则对象的常用方法"><a href="#2-2-正则对象的常用方法" class="headerlink" title="2.2 正则对象的常用方法"></a>2.2 正则对象的常用方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg.test(<span class="string">&quot;字符串&quot;</span>)  <span class="comment">//查看字符串是否符合指定的正则表达式，返回true和false</span></span><br><span class="line">reg.exec(<span class="string">&quot;字符串&quot;</span>)  <span class="comment">//用正则表达式模式在字符串中运行查找，并返回包含该查找结果的一个数组</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-匹配正则表达式"><a href="#2-3-匹配正则表达式" class="headerlink" title="2.3 匹配正则表达式"></a>2.3 匹配正则表达式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在字符串中查找是否有符合条件的</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-zA-Z]+/</span>.test(<span class="string">&quot;hello&quot;</span>));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/./</span>.test(<span class="string">&quot;除了回车换行以为的任意字符&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/.*/</span>.test(<span class="string">&quot;0个到多个&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/.+/</span>.test(<span class="string">&quot;1个到多个&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/.?/</span>.test(<span class="string">&quot;哈哈&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-z]/</span>.test(<span class="string">&quot;what&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[A-Z]/</span>.test(<span class="string">&quot;Are&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-zA-Z]/</span>.test(<span class="string">&quot;干啥子&quot;</span>));<span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[0-9a-zA-Z]/</span>.test(<span class="string">&quot;9ebg&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/b|(ara)/</span>.test(<span class="string">&quot;abra&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-z]&#123;2,3&#125;/</span>.test(<span class="string">&quot;arfsf&quot;</span>));<span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d/</span>.test(<span class="string">&quot;998&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d*/</span>.test(<span class="string">&quot;998&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d+/</span>.test(<span class="string">&quot;998&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d&#123;0,&#125;/</span>.test(<span class="string">&quot;998&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d&#123;2,3&#125;/</span>.test(<span class="string">&quot;998&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\D/</span>.test(<span class="string">&quot;eat&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\s/</span>.test(<span class="string">&quot;  &quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\S/</span>.test(<span class="string">&quot;嘎嘎&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\w/</span>.test(<span class="string">&quot;_&quot;</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\W/</span>.test(<span class="string">&quot;_&quot;</span>));<span class="comment">//fasle</span></span><br></pre></td></tr></table></figure>

<h3 id="2-4-正则匹配案例"><a href="#2-4-正则匹配案例" class="headerlink" title="2.4 正则匹配案例"></a>2.4 正则匹配案例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.查看字符串是否包含数字</span></span><br><span class="line"><span class="comment">//var reg = new RegExp(&quot;\\d+&quot;);</span></span><br><span class="line"><span class="keyword">var</span> reg =<span class="regexp">/\d+/</span>;  <span class="comment">//相比上面写法少了转义字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// test 方法检查在字符串中是否存在一个模式，如果存在则返回 true，否则就返回 false。</span></span><br><span class="line">alert(reg.test(<span class="string">&quot;abc123&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.需求：校验QQ号码</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/^[1-9]\d&#123;4,10&#125;$/</span>;</span><br><span class="line">alert(reg.test(<span class="string">&quot;11533&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.固定电话的正则</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/^(0\d&#123;2,3&#125;-)?[1-9]\d&#123;7&#125;$/</span>;</span><br><span class="line">alert(reg.test(<span class="string">&quot;021-88882222&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.匹配日期</span></span><br><span class="line"><span class="keyword">var</span> dateStr = <span class="string">&#x27;2015-10-10&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;$/</span></span><br><span class="line"><span class="built_in">console</span>.log(reg.test(dateStr));</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.查看字符串是否以数字开头以数字结束</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/^(\d+)$|^(\d+)(.)*(\d+)$/</span>;</span><br><span class="line">alert(reg.test(<span class="string">&quot;abc123&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//注意点：其中^表示开头，$表示结束，/^\d+$/表示需要匹配的字符串必须以数字开头，必须以数字结束。如果去掉，则会进行部分匹配</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//6.验证中文名字(2到6位)</span></span><br><span class="line"><span class="keyword">var</span> reg=<span class="regexp">/^[\u4e00-\u9fa5]&#123;2,6&#125;$/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//7.需求：找出所有3个英文字母组成的单词</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;da Jia hao hao xue xi zheng qu sheng lii&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/\b[a-z]&#123;3&#125;\b/ig</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// exec 方法:用正则表达式模式在字符串中运行查找，并返回包含该查找结果的一个数组。</span></span><br><span class="line"><span class="keyword">while</span>((line = reg.exec(str)) !=<span class="literal">null</span>)&#123;</span><br><span class="line">      alert(line);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//8.把里面所有的数字全部显示出来</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;中国移动:10086,中国联通:10010,中国电信:10000&quot;</span>; </span><br><span class="line"><span class="keyword">var</span> reg=<span class="regexp">/\d&#123;5&#125;/g</span>;</span><br><span class="line"><span class="comment">//通过正则表达式匹配这个字符串</span></span><br><span class="line"><span class="keyword">var</span> line=reg.exec(str);</span><br><span class="line"><span class="keyword">while</span> (line!=<span class="literal">null</span>)&#123;</span><br><span class="line">   <span class="comment">//输出匹配的内容</span></span><br><span class="line">   <span class="built_in">console</span>.log(line[<span class="number">0</span>]);</span><br><span class="line">   line=reg.exec(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-5-分组提取"><a href="#2-5-分组提取" class="headerlink" title="2.5 分组提取"></a>2.5 分组提取</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 1. 提取日期中的年部分  2015-5-10</span></span><br><span class="line"><span class="keyword">var</span> dateStr = <span class="string">&#x27;2016-1-5&#x27;</span>;</span><br><span class="line"><span class="comment">// 正则表达式中的()作为分组来使用，获取分组匹配到的结果用Regex.$1 $2 $3....来获取</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/(\d&#123;4&#125;)-\d&#123;1,2&#125;-\d&#123;1,2&#125;/</span>;</span><br><span class="line"><span class="keyword">if</span> (reg.test(dateStr)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 提取邮件中的每一部分</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/(\w+)@(\w+)\.(\w+)(\.\w+)?/</span>;</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;123123@xx.com&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">2</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-字符串中正则的使用"><a href="#3-字符串中正则的使用" class="headerlink" title="3. 字符串中正则的使用"></a>3. 字符串中正则的使用</h2><h3 id="3-1-字符串中支持正则方法"><a href="#3-1-字符串中支持正则方法" class="headerlink" title="3.1 字符串中支持正则方法"></a>3.1 字符串中支持正则方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">match()    <span class="comment">//match方法返回符合条件的集合</span></span><br><span class="line">replace()  <span class="comment">//替换字符串</span></span><br><span class="line">search()   <span class="comment">//查找字符串</span></span><br><span class="line">split()    <span class="comment">//切割字符串</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-字符串正则提取"><a href="#3-2-字符串正则提取" class="headerlink" title="3.2 字符串正则提取"></a>3.2 字符串正则提取</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//match方法返回符合条件的集合</span></span><br><span class="line"><span class="comment">//1.查找字符串中所有连续出现的数字，放入数组</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;abc123ee23f90&quot;</span>;</span><br><span class="line">alert(str.match(<span class="regexp">/\d+/g</span>));</span><br><span class="line">alert(str.match(<span class="regexp">/\d+/</span>));<span class="comment">//如果这里没有/g，只会找到第一个符合条件的放入数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.查找字符串中所有的数字，放入数组</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;abc123ee23f90&quot;</span>;</span><br><span class="line">alert(str.match(<span class="regexp">/\d/g</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 提取工资</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;张三：1000，李四：5000，王五：8000。&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> array = str.match(<span class="regexp">/\d+/g</span>); </span><br><span class="line"><span class="built_in">console</span>.log(array);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 提取email地址</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;123123@xx.com,fangfang@valuedopinions.cn 286669312@qq.com 2、emailenglish@emailenglish.englishtown.com 286669312@qq.com...&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> array = str.match(<span class="regexp">/\w+@\w+\.\w+(\.\w+)?/g</span>);  <span class="comment">//(\.\w+)?  表示可能出现0次或者多次</span></span><br><span class="line"><span class="built_in">console</span>.log(array);</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.把里面所有的数字全部显示出来</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;中国移动:10086,中国联通:10010,中国电信:10000&quot;</span>; </span><br><span class="line"><span class="keyword">var</span> array=str.match(<span class="regexp">/\d&#123;5&#125;/g</span>);</span><br><span class="line"><span class="built_in">console</span>.log(array);</span><br></pre></td></tr></table></figure>

<h3 id="3-3-贪婪模式和懒惰模式"><a href="#3-3-贪婪模式和懒惰模式" class="headerlink" title="3.3 贪婪模式和懒惰模式"></a>3.3 贪婪模式和懒惰模式</h3><p>所谓贪婪匹配就是匹配重复字符是尽可能多的匹配</p>
<p>懒惰模式就是匹配的时候尽可能的少匹配</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;aaaaa&quot;</span>.match(<span class="regexp">/a+/</span>);    <span class="comment">//贪婪模式：[&quot;aaaaa&quot;]</span></span><br><span class="line"><span class="string">&quot;aaaaa&quot;</span>.match(<span class="regexp">/a+?/</span>);   <span class="comment">//懒惰模式(使用?号)：[&quot;a&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;0a123ba123b&#x27;</span>.match(<span class="regexp">/a[a-b0-9]*b/</span>);      <span class="comment">//贪婪模式: [&quot;a123ba123b&quot;]</span></span><br><span class="line"><span class="string">&#x27;0a123ba123b&#x27;</span>.match(<span class="regexp">/a[a-b0-9]*?b/</span>);  <span class="comment">//懒惰模式 ：[&quot;a123b&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//按照贪婪和懒惰模式，下面的结有问题：</span></span><br><span class="line"><span class="string">&quot;aaab&quot;</span>.match(<span class="regexp">/a+b/</span>);   <span class="comment">//[&quot;aaab&quot;]</span></span><br><span class="line"><span class="string">&quot;aaab&quot;</span>.match(<span class="regexp">/a+?b/</span>);  <span class="comment">//[&quot;aaab&quot;]  这边明明是懒惰模式，可是匹配结果仍然是&quot;aaab&quot;</span></span><br><span class="line"><span class="comment">//原因是正则表达式的模式匹配总是会寻找字符串中第一个可能匹配的位置。</span></span><br></pre></td></tr></table></figure>

<h3 id="3-4-字符串正则替换"><a href="#3-4-字符串正则替换" class="headerlink" title="3.4 字符串正则替换"></a>3.4 字符串正则替换</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 替换所有空白</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;   123AD  asadf   asadfasf  adf &quot;</span>;</span><br><span class="line">str = str.replace(<span class="regexp">/\s/g</span>,<span class="string">&quot;xx&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 替换所有,|，</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;abc,efg,123，abc,123，a&quot;</span>;</span><br><span class="line">str = str.replace(<span class="regexp">/,|，/g</span>, <span class="string">&quot;.&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.替换字符串中所有的 – 和 + 号</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;a-b-+b-c&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/-|\+/g</span>;  <span class="comment">//注意，此处没有加边界匹配器，因为要替换所有的-,g表示匹配的模式,+号需要转义</span></span><br><span class="line">alert(str.replace(reg, <span class="string">&quot;*&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.替换字符串中的所有的帅</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;你好帅哦,真的是太帅了,帅,就是真帅&quot;</span>;</span><br><span class="line">str=str.replace(<span class="regexp">/帅/g</span>,<span class="string">&quot;猥琐&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.替换字符串中的所有的h</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;HhpphH&quot;</span>;<span class="comment">//SSppSS</span></span><br><span class="line">str=str.replace(<span class="regexp">/[h]/gi</span>,<span class="string">&quot;S&quot;</span>);  <span class="comment">//i忽略大小写</span></span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line"><span class="comment">//6.替换重叠词</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;妮妮好好啊，我好喜喜欢你&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> str1 = str.replace(<span class="regexp">/(.)\1+/g</span>,<span class="string">&quot;$1&quot;</span>)</span><br><span class="line">alert(str1);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//7.替换标签为空字符串</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;&lt;p&gt; 你好小明 &lt;/p&gt; &lt;div&gt;王鹏&lt;/div&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/&lt;[^&lt;&gt;]+&gt;/g</span>;  <span class="comment">//标签中除了&lt;&gt;不能放，其他都能放，所以是[^&lt;&gt;]</span></span><br><span class="line">alert(str.replace(reg, <span class="string">&quot;&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><img src="%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/bb.png"></p>
<h3 id="3-5-字符串正则其他方法"><a href="#3-5-字符串正则其他方法" class="headerlink" title="3.5 字符串正则其他方法"></a>3.5 字符串正则其他方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.查找字符串中指定字符</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;a-b-b-c&quot;</span>;</span><br><span class="line"><span class="comment">//忽略大小写查找</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/a/i</span>;  </span><br><span class="line"><span class="comment">//打印结果是所查找的内容在字符串中出现的第一个位置</span></span><br><span class="line">alert(str.search(reg));</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.切割字符串</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;a|b|c|&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> arr=str.split(<span class="regexp">/\W+/</span>);</span><br><span class="line">alert(arr)</span><br></pre></td></tr></table></figure>

<h3 id="3-6-正则案例：验证密码强度"><a href="#3-6-正则案例：验证密码强度" class="headerlink" title="3.6 正则案例：验证密码强度"></a>3.6 正则案例：验证密码强度</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;dv&quot;</span>&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">&quot;pwd&quot;</span>&gt;密码&lt;/label&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;text&quot;</span> id=<span class="string">&quot;pwd&quot;</span> maxlength=<span class="string">&quot;16&quot;</span>&gt;&lt;!--课外话题--&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;em&gt;密码强度：&lt;/em&gt;</span><br><span class="line">        &lt;em id=<span class="string">&quot;strength&quot;</span>&gt;&lt;/em&gt;</span><br><span class="line">        &lt;div id=<span class="string">&quot;strengthLevel&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;strengthLv0&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;common.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style type=<span class="string">&quot;text/css&quot;</span>&gt;</span><br><span class="line">    #dv&#123;</span><br><span class="line">        width: <span class="number">300</span>px;</span><br><span class="line">        height:<span class="number">200</span>px;</span><br><span class="line">        position: absolute;</span><br><span class="line">        left:<span class="number">300</span>px;</span><br><span class="line">        top:<span class="number">100</span>px;</span><br><span class="line">    &#125;</span><br><span class="line">    .strengthLv0 &#123;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">120</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .strengthLv1 &#123;</span><br><span class="line">        background: red;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">40</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .strengthLv2 &#123;</span><br><span class="line">        background: orange;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">80</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .strengthLv3 &#123;</span><br><span class="line">        background: green;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">120</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .strengthLv4 &#123;</span><br><span class="line">        background: black;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">150</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">my$(<span class="string">&quot;pwd&quot;</span>).onkeyup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> value = <span class="built_in">this</span>.value;</span><br><span class="line">    <span class="keyword">var</span> level = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//1.如果输入的内容中函数字  强度是0</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="regexp">/\d+/</span>.test(value))&#123;</span><br><span class="line">        level++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.如果输入的内容含小写字母  强度是1</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="regexp">/[a-z]+/</span>.test(value))&#123;</span><br><span class="line">        level++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3.如果输入的内容含大写字母  强度是2</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="regexp">/[A-Z]+/</span>.test(value))&#123;</span><br><span class="line">        level++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//4.如果输入的内容含非字符  强度是3</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="regexp">/\W+/</span>.test(value))&#123;</span><br><span class="line">        level++;</span><br><span class="line">    &#125;</span><br><span class="line">    my$(<span class="string">&quot;strengthLevel&quot;</span>).className = <span class="string">&quot;strengthLv&quot;</span>+level;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-7-正则案例：表单验证"><a href="#3-7-正则案例：表单验证" class="headerlink" title="3.7 正则案例：表单验证"></a>3.7 正则案例：表单验证</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">QQ号：&lt;input type=<span class="string">&quot;text&quot;</span> id=<span class="string">&quot;txtQQ&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line">邮箱：&lt;input type=&quot;text&quot; id=&quot;txtEMail&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;</span><br><span class="line">手机：&lt;input type=&quot;text&quot; id=&quot;txtPhone&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;</span><br><span class="line">生日：&lt;input type=&quot;text&quot; id=&quot;txtBirthday&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;</span><br><span class="line">姓名：&lt;input type=&quot;text&quot; id=&quot;txtName&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">//1.获取页面所有的inputs</span><br><span class="line">var inputs = my$byTagName(&quot;input&quot;);</span><br><span class="line">//2.遍历inputs绑定事件</span><br><span class="line">for(var i=0;i&lt;inputs.length;i++)&#123;</span><br><span class="line">    inputs[i].onblur = function()&#123;</span><br><span class="line">        checkCorrect(this);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//3.每次文本框失去焦点时候确定文本框对应的正则以及提示</span><br><span class="line">function checkCorrect(ele)&#123;</span><br><span class="line">    var reg = null;</span><br><span class="line">    var tip = null;</span><br><span class="line">    //检验QQ</span><br><span class="line">    if(ele.getAttribute(&quot;name&quot;) == &quot;qq&quot;) &#123;</span><br><span class="line">        reg = /^[1-9]\d&#123;4,10&#125;$/;</span><br><span class="line">        tip = &quot;请输入正确的QQ号码&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    //校验email</span><br><span class="line">    else if(ele.getAttribute(&quot;name&quot;) == &quot;email&quot;)&#123;</span><br><span class="line">        reg = /^\w+@\w+\.\w+(\.\w+)?$/;</span><br><span class="line">        tip = &quot;请输入正确的email&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else if(ele.getAttribute(&quot;name&quot;) == &quot;phone&quot;)&#123;</span><br><span class="line">        reg = /^1[34578]\d&#123;9&#125;$/;</span><br><span class="line">        tip = &quot;请输入正确的手机号码&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else if(ele.getAttribute(&quot;name&quot;) == &quot;birthday&quot;)&#123;</span><br><span class="line">        reg = /^((\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;))$/;</span><br><span class="line">        tip = &quot;请输入正确的生日&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else if(ele.getAttribute(&quot;name&quot;) == &quot;name&quot;)&#123;</span><br><span class="line">        reg = /^\w&#123;2,&#125;$/;</span><br><span class="line">        tip = &quot;请输入正确的名字&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    //真正去进行校验</span><br><span class="line">    doCheck(ele,reg,tip);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//正则的校验</span><br><span class="line">function doCheck(element, reg, tip)&#123;</span><br><span class="line">    //获取当前input的下一个兄弟元素</span><br><span class="line">    var span = element.nextElementSibling;</span><br><span class="line">    //如果正则校验通过，则输入正确</span><br><span class="line">    if(reg.test(element.value))&#123;</span><br><span class="line">        span.style.color = &quot;green&quot;;</span><br><span class="line">        setInnerText(span,&quot;输入正确&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        span.style.color = &quot;red&quot;;</span><br><span class="line">        setInnerText(span,tip);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id=""><a href="#" class="headerlink" title=""></a></h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/04/22/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" data-id="ckdzwmbdn00150wv0042r4nrm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vue-cli的使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/29/vue-cli%E7%9A%84%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2019-03-29T05:36:06.000Z" itemprop="datePublished">2019-03-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/vue/">vue</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/29/vue-cli%E7%9A%84%E4%BD%BF%E7%94%A8/">vue-cli的使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-vue-cli使用"><a href="#1-vue-cli使用" class="headerlink" title="1.vue-cli使用"></a>1.vue-cli使用</h2><p>vue-cli是vue官网提供的一个脚手架，这个构建工具大大降低了webpack的使用难度，支持热更新，有<strong>webpack-dev-server</strong>的支持，相当于启动了一个请求服务器，给你搭建了一个测试环境，只关注开发就OK</p>
<h3 id="1-1-安装vue-cli创建项目"><a href="#1-1-安装vue-cli创建项目" class="headerlink" title="1.1 安装vue-cli创建项目"></a>1.1 安装vue-cli创建项目</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.npm install -g @vue&#x2F;cli@3.9.1</span><br><span class="line">2.将配置环境变量  C:\dev\nodejs</span><br><span class="line">3.vue create project-name</span><br></pre></td></tr></table></figure>

<p><img src="vue-cli%E7%9A%84%E4%BD%BF%E7%94%A8/1548217691062.png" alt="1548217691062"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查看最终生效的 webpack 配置信息</span></span><br><span class="line">vue inspect &gt; output.js</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置文件参考文档</span></span><br><span class="line">https:<span class="comment">//cli.vuejs.org/zh/config/#devserver-proxy</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//运行App</span></span><br><span class="line">npm run serve</span><br><span class="line"></span><br><span class="line"><span class="comment">//编译App</span></span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<p><img src="vue-cli%E7%9A%84%E4%BD%BF%E7%94%A8/1548290537572.png" alt="1548290537572"></p>
<h3 id="1-2-windows-32位-npm装不上vue-cli的问题"><a href="#1-2-windows-32位-npm装不上vue-cli的问题" class="headerlink" title="1.2 windows(32位) npm装不上vue/cli的问题"></a>1.2 windows(32位) npm装不上vue/cli的问题</h3><p><img src="vue-cli%E7%9A%84%E4%BD%BF%E7%94%A8/1562661036910.png" alt="1562661036910"></p>
<p><img src="vue-cli%E7%9A%84%E4%BD%BF%E7%94%A8/1562661053769.png" alt="1562661053769"></p>
<p><img src="vue-cli%E7%9A%84%E4%BD%BF%E7%94%A8/1562661089819.png" alt="1562661089819"></p>
<h3 id="1-3-vue-config-js配置"><a href="#1-3-vue-config-js配置" class="headerlink" title="1.3 vue.config.js配置"></a>1.3 vue.config.js配置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//官网配置： https://cli.vuejs.org/zh/config/#filenamehashing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> debug = process.env.NODE_ENV !== <span class="string">&#x27;production&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//部署应用包时的基本URL，如果是生产环境，部署到 /cli-study/dist 路径；如果是开发环境，部署到根路径</span></span><br><span class="line">  publicPath: !debug</span><br><span class="line">      ? <span class="string">&#x27;/cli-study/dist&#x27;</span></span><br><span class="line">      : <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">  <span class="comment">//输出文件路径</span></span><br><span class="line">  outputDir: <span class="string">&#x27;dist&#x27;</span>,</span><br><span class="line">  <span class="comment">//放置生成的静态资源 (js、css、img、fonts) 的 (相对于 outputDir 的) 目录。</span></span><br><span class="line">  assetsDir: <span class="string">&#x27;static&#x27;</span>,</span><br><span class="line">  <span class="comment">//默认情况下，生成的静态资源在它们的文件名中包含了 hash 以便更好的控制缓存</span></span><br><span class="line">  filenameHashing: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// eslint-loader 是否在保存的时候检查</span></span><br><span class="line">  lintOnSave: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// 是否使用包含运行时编译器的Vue构建版本，设置为 true 后你就可以在 Vue 组件中使用 template 选项了，但是这会让你的应用额外增加 10kb 左右。</span></span><br><span class="line">  runtimeCompiler: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 默认情况下 babel-loader 会忽略所有 node_modules 中的文件。如果你想要通过 Babel 显式转译一个依赖，可以在这个选项中列出来。</span></span><br><span class="line">  transpileDependencies: [],</span><br><span class="line">  <span class="comment">// 生产环境不需要sourceMap</span></span><br><span class="line">  productionSourceMap: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 官网：https://cli.vuejs.org/zh/guide/webpack.html#%E7%AE%80%E5%8D%95%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F</span></span><br><span class="line">  <span class="comment">// 更多配置参考：https://www.jb51.net/article/150844.htm</span></span><br><span class="line">  configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">Object</span>.assign(config, &#123; <span class="comment">// 开发生产共同配置</span></span><br><span class="line">      resolve: &#123;</span><br><span class="line">        alias: &#123;</span><br><span class="line">          <span class="string">&#x27;@&#x27;</span>: path.resolve(__dirname, <span class="string">&#x27;./src&#x27;</span>),</span><br><span class="line">          <span class="string">&#x27;vue$&#x27;</span>: <span class="string">&#x27;vue/dist/vue.esm.js&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// webpack的链式操作，允许对内部的 webpack 配置进行更细粒度的修改</span></span><br><span class="line">  <span class="comment">// 参考： https://cli.vuejs.org/zh/guide/webpack.html#%E9%93%BE%E5%BC%8F%E6%93%8D%E4%BD%9C-%E9%AB%98%E7%BA%A7</span></span><br><span class="line">  chainWebpack: <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (debug) &#123;</span><br><span class="line">      <span class="comment">// 本地开发配置</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 生产开发配置</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// css的相关配置</span></span><br><span class="line">  css: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//所有 webpack-dev-server 的选项都支持</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    open: <span class="literal">true</span>,</span><br><span class="line">    host: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    port: <span class="number">3000</span>,</span><br><span class="line">    https: <span class="literal">false</span>,</span><br><span class="line">    hotOnly: <span class="literal">false</span>,</span><br><span class="line">    proxy: <span class="literal">null</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 第三方插件配置</span></span><br><span class="line">  pluginOptions: &#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-vue-cli搭建项目"><a href="#1-4-vue-cli搭建项目" class="headerlink" title="1.4 vue-cli搭建项目"></a>1.4 vue-cli搭建项目</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue create project_name</span><br></pre></td></tr></table></figure>

<h3 id="1-5-Eslint格式化-vue文件"><a href="#1-5-Eslint格式化-vue文件" class="headerlink" title="1.5 Eslint格式化.vue文件"></a>1.5 Eslint格式化.vue文件</h3><p>ESLint是一个用来识别 ECMAScript 并且按照规则给出报告的代码检测工具，使用它可以避免低级错误和统一代码的风格。</p>
<p>你可能有疑问，在.vue 文件中你怎么检验你的代码，因为它不是 JavaScript。我们假设你使用 <a target="_blank" rel="noopener" href="https://eslint.org/">ESLint</a> (如果你没有使用话，你应该去使用！)。</p>
<p>你还需要官方的 <a target="_blank" rel="noopener" href="https://github.com/vuejs/eslint-plugin-vue">eslint-plugin-vue</a>，它支持同时检查你.vue文件中的模板和脚本。</p>
<p><a target="_blank" rel="noopener" href="https://vue-loader-v14.vuejs.org/zh-cn/workflow/linting.html">https://vue-loader-v14.vuejs.org/zh-cn/workflow/linting.html</a></p>
<h4 id="a-eslint配置-rules规则"><a href="#a-eslint配置-rules规则" class="headerlink" title="a) eslint配置(rules规则)"></a>a) eslint配置(rules规则)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关闭必须使用单引号</span></span><br><span class="line"><span class="string">&quot;quotes&quot;</span>: [<span class="number">0</span>, <span class="string">&quot;single&quot;</span>],</span><br><span class="line"><span class="comment">// 允许多余的换行</span></span><br><span class="line"><span class="string">&quot;no-multi-spaces&quot;</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;no-console&#x27;</span>: process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;error&#x27;</span> : <span class="string">&#x27;off&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;no-debugger&#x27;</span>: process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;error&#x27;</span> : <span class="string">&#x27;off&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;prefer-promise-reject-errors&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;space-unary-ops&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;no-unused-expressions&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;no-useless-return&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;standard/no-callback-literal&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;import/first&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;import/export&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;no-mixed-operators&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;no-use-before-define&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不允许使用分号</span></span><br><span class="line"><span class="string">&#x27;semi&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;never&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 允许使用==</span></span><br><span class="line"><span class="string">&#x27;eqeqeq&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 缩进使用不做限制</span></span><br><span class="line"><span class="string">&#x27;indent&#x27;</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 允许使用tab</span></span><br><span class="line"><span class="string">&#x27;no-tabs&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数圆括号之前没有空格</span></span><br><span class="line"><span class="string">&#x27;space-before-function-paren&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;never&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不要求块内空格填充格式</span></span><br><span class="line"><span class="string">&#x27;padded-blocks&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不限制变量一起声明</span></span><br><span class="line"><span class="string">&#x27;one-var&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 条件语句中复制操作符需要用圆括号括起来</span></span><br><span class="line"><span class="string">&#x27;no-cond-assign&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;except-parens&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 允许使用条件表达式使用常量</span></span><br><span class="line"><span class="string">&#x27;no-constant-condition&#x27;</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 单行可忽略大括号，多行不可忽略</span></span><br><span class="line"><span class="string">&#x27;curly&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;multi-line&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不允许使用var变量</span></span><br><span class="line"><span class="string">&#x27;no-var&#x27;</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不允许出现多个空格</span></span><br><span class="line"><span class="string">&#x27;no-multi-spaces&#x27;</span>: [<span class="string">&#x27;error&#x27;</span>, &#123; <span class="attr">ignoreEOLComments</span>: <span class="literal">true</span> &#125;],</span><br><span class="line"><span class="string">&#x27;camelcase&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象字面量的键值空格风格</span></span><br><span class="line"><span class="string">&#x27;key-spacing&#x27;</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// if语句包含一个return语句， else就多余</span></span><br><span class="line"><span class="string">&#x27;no-else-return&#x27;</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 建议将经常出现的数字提取为变量</span></span><br><span class="line"><span class="string">&#x27;no-magic-numbers&#x27;</span>: [<span class="number">0</span>, &#123; <span class="attr">ignoreArrayIndexes</span>: <span class="literal">true</span> &#125;],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不允许重复声明变量</span></span><br><span class="line"><span class="string">&#x27;no-redeclare&#x27;</span>: [<span class="number">2</span>, &#123; <span class="attr">builtinGlobals</span>: <span class="literal">true</span> &#125;],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 立即执行函数风格</span></span><br><span class="line"><span class="string">&#x27;wrap-iife&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;inside&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不允许圆括号中出现空格</span></span><br><span class="line"><span class="string">&#x27;space-in-parens&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;never&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 确保运算符周围有空格</span></span><br><span class="line"><span class="string">&#x27;space-infix-ops&#x27;</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 强制点号与属性同一行</span></span><br><span class="line"><span class="string">&#x27;dot-location&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;property&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 强制单行代码使用空格</span></span><br><span class="line"><span class="string">&#x27;block-spacing&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;always&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 约束for-in使用hasOwnProperty判断</span></span><br><span class="line"><span class="string">&#x27;guard-for-in&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 采用one true brace style大括号风格</span></span><br><span class="line"><span class="string">&#x27;brace-style&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;1tbs&#x27;</span>, &#123; <span class="string">&#x27;allowSingleLine&#x27;</span>: <span class="literal">true</span> &#125;],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 统一逗号周围空格风格</span></span><br><span class="line"><span class="string">&#x27;comma-spacing&#x27;</span>: [<span class="number">2</span>, &#123; <span class="string">&#x27;before&#x27;</span>: <span class="literal">false</span>, <span class="string">&#x27;after&#x27;</span>: <span class="literal">true</span> &#125;],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 禁止出现多个空行</span></span><br><span class="line"><span class="string">&#x27;no-multiple-empty-lines&#x27;</span>: [<span class="number">2</span>, &#123; <span class="string">&#x27;max&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;maxEOF&#x27;</span>: <span class="number">2</span> &#125;],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 允许箭头函数不使用圆括号</span></span><br><span class="line"><span class="string">&#x27;arrow-parens&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 规范generator函数的使用</span></span><br><span class="line"><span class="string">&#x27;generator-star-spacing&#x27;</span>: [<span class="number">2</span>, &#123; <span class="string">&#x27;before&#x27;</span>: <span class="literal">false</span>, <span class="string">&#x27;after&#x27;</span>: <span class="literal">true</span> &#125;],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 要求在块级</span></span><br><span class="line"><span class="string">&#x27;lines-around-comment&#x27;</span>: [<span class="number">2</span>, &#123; <span class="string">&#x27;beforeBlockComment&#x27;</span>: <span class="literal">true</span>, <span class="string">&#x27;afterBlockComment&#x27;</span>: <span class="literal">false</span>, <span class="string">&#x27;beforeLineComment&#x27;</span>: <span class="literal">true</span>, <span class="string">&#x27;afterLineComment&#x27;</span>: <span class="literal">false</span> &#125;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;off&quot;</span>或者<span class="number">0</span>，不启用这个规则</span><br><span class="line"><span class="string">&quot;warn&quot;</span>或者<span class="number">1</span>，出现问题会有警告</span><br><span class="line"><span class="string">&quot;error&quot;</span>或者<span class="number">2</span>，出现问题会报错</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/vuejs/eslint-plugin-vue/blob/master/docs/rules/README.md">https://github.com/vuejs/eslint-plugin-vue/blob/master/docs/rules/README.md</a></p>
<blockquote>
<p>注意：”extends”: “plugin:vue/recommended” 会同时检查js和模板的语法错误</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vscode中通过  npm run lint会自动进行eslint的校验和修正</span><br><span class="line">npm run lint --fix</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/29/vue-cli%E7%9A%84%E4%BD%BF%E7%94%A8/" data-id="ckdzwmbdi000p0wv07uzjha23" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-简述Js中的原型与原型链" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/22/%E7%AE%80%E8%BF%B0Js%E4%B8%AD%E7%9A%84%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE/" class="article-date">
  <time datetime="2019-03-22T04:13:38.000Z" itemprop="datePublished">2019-03-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/22/%E7%AE%80%E8%BF%B0Js%E4%B8%AD%E7%9A%84%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE/">简述Js中的原型与原型链</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-原型"><a href="#1-原型" class="headerlink" title="1.原型"></a>1.原型</h2><p> Javascript是基于对象的编程语言，他其中也含有部分封装、继承的概念，而原型概念便是基于继承的。</p>
<p> 函数的原型类似于面向对象语言中子类的父类，而函数本身类似于子类。函数继承了函数原型中的属性和方法，即函数本身可以调用它原型中的属性和方法。</p>
<p> 知识点：若有函数Person，则它的函数原型为Person.prototype，函数原型本身是个对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function Person (name) &#123;</span><br><span class="line">  this.name &#x3D; name;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.type &#x3D; &#39;human&#39;</span><br><span class="line">Person.prototype.sayName &#x3D; function () &#123;</span><br><span class="line">  console.log(this.name + &#39;说话了&#39;)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;此时我们用Person构造函数构造了一个p对象</span><br><span class="line">var p &#x3D; new Person(&#39;小王&#39;);</span><br><span class="line">&#x2F;&#x2F;我们打印p.name</span><br><span class="line">console.log(p.name); &#x2F;&#x2F;结果是&#39;小王&#39;，因为Preson函数中已经预置了name属性并且接受了new对象时传入的&#39;小王&#39;，结果勿容置疑</span><br><span class="line">&#x2F;&#x2F;我们再打印p.type 调用p.sayName()  按常理说Preson构造函数中是不存在type属性和sayName方法，若调用应该会报错</span><br><span class="line">console.log(p.type); &#x2F;&#x2F;结果  human</span><br><span class="line">p.sayName(); &#x2F;&#x2F; 结果  小王说话了</span><br><span class="line">&#x2F;&#x2F;结果和我们预想的不同，这是为什么呢?</span><br><span class="line">&#x2F;&#x2F;因为Person继承了它原型Person.prototype中的信息，当调用p.type时，会优先在Person类中找该属性，若找到了则直接使用，若没找到则在他的原型中找并使用。因为我们设置了Person原型的type属性的，则p可以直接使用</span><br></pre></td></tr></table></figure>

<p>在上面的例子中涉及到了 构造函数、对象和函数原型，接下来给出三者之间的关系图；</p>
<h2 id="2-构造函数、实例、原型三者之间的关系"><a href="#2-构造函数、实例、原型三者之间的关系" class="headerlink" title="2.构造函数、实例、原型三者之间的关系"></a>2.构造函数、实例、原型三者之间的关系</h2><p><img src="%E7%AE%80%E8%BF%B0Js%E4%B8%AD%E7%9A%84%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE/yuanxing1.png"></p>
<p>由图中我们可以很直观的看到三者之间的关系。</p>
<p>p对象由Person构造函数构造</p>
<p>p对象通过__proto__属性访问到Person对象原型</p>
<p>Person对象原型通过constructor访问Person构造函数</p>
<p>Person函数通过prototype属性访问到Person原型对象</p>
<p>注意：对象是通过__proto__属性访问对象原型，函数是通过prototype访问对象原型，但两者访问到的对象原型是同一个</p>
<p>验证：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.log(p.__proto__ &#x3D;&#x3D; Person.prototype); &#x2F;&#x2F;结果为 true</span><br></pre></td></tr></table></figure>

<p>constructor的作用：可以使得对象访问到对应的构造函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function Person()&#123;</span><br><span class="line">&#125;</span><br><span class="line">var p &#x3D; new Person();</span><br><span class="line">console.log(p.constructor);&#x2F;&#x2F; 打印  function Person()</span><br></pre></td></tr></table></figure>

<p>知道以上的知识之后，我们还要了解，其实Person的原型也有原型，即存在Person.prototype.prototype，并且它是Person.prototype的原型，可以用图来直观了解这其中的关系，这便是一个简单的原型链。</p>
<h2 id="3、原型链"><a href="#3、原型链" class="headerlink" title="3、原型链"></a>3、原型链</h2><p><img src="%E7%AE%80%E8%BF%B0Js%E4%B8%AD%E7%9A%84%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE/yuanxing2.png"></p>
<h2 id="4、原型链中的搜索规则"><a href="#4、原型链中的搜索规则" class="headerlink" title="4、原型链中的搜索规则"></a>4、原型链中的搜索规则</h2><p>了解了 <strong>构造函数-实例-原型对象</strong> 三者之间的关系后，接下来我们来解释一下为什么实例对象可以访问原型对象中的成员。</p>
<p>每当代码读取某个对象的某个属性时，都会执行一次搜索，目标是具有给定名字的属性</p>
<ul>
<li>搜索首先从对象实例本身开始</li>
<li>如果在实例中找到了具有给定名字的属性，则返回该属性的值</li>
<li>如果没有找到，则继续搜索指针指向的原型对象，在原型对象中查找具有给定名字的属性</li>
<li>如果在原型对象中找到了这个属性，则返回该属性的值</li>
</ul>
<p>也就是说，在我们调用 <code>p.sayName()</code> 的时候，会先后执行两次搜索：</p>
<ul>
<li>首先，解析器会问：“实例 p 有 sayName 属性吗？”答：“没有。</li>
<li>”然后，它继续搜索，再问：“ p 的原型有 sayName 属性吗？”答：“有。</li>
<li>”于是，它就读取那个保存在原型对象中的函数。</li>
</ul>
<p>而这正是多个对象实例共享原型所保存的属性和方法的基本原理。</p>
<p>总结：</p>
<ul>
<li>先在自己身上找，找到即返回</li>
<li>自己身上找不到，则沿着原型链向上查找，找到即返回</li>
<li>如果一直到原型链的末端还没有找到，则返回 <code>undefined</code></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/22/%E7%AE%80%E8%BF%B0Js%E4%B8%AD%E7%9A%84%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE/" data-id="ckdzwmbdn00170wv0hnkg9mu6" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/react/">react</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue/">vue</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/18/%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2/">我的博客</a>
          </li>
        
          <li>
            <a href="/2020/08/14/hhh/">hhh</a>
          </li>
        
          <li>
            <a href="/2020/08/13/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2020/03/27/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAreact-hooks/">深入浅出react hooks</a>
          </li>
        
          <li>
            <a href="/2020/03/22/nextJS/">nextJS</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>